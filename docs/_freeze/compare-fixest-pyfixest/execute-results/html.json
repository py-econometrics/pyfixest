{
  "hash": "3c3a2fdf7f84d7d8e17ed9f5862cd511",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Does `PyFixest` match `fixest`?\ntoc: true\ntoc-title: \"On this page\"\ntoc-location: left\n---\n\nThis vignette compares estimation results from `fixest` with `pyfixest` via the `rpy2` package.\n\n## Setup\n\n::: {#597b9b80 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport rpy2.robjects as ro\nfrom rpy2.robjects import pandas2ri\nfrom rpy2.robjects.packages import importr\n\nimport pyfixest as pf\n\n# Activate pandas2ri\npandas2ri.activate()\n\n# Import R packages\nfixest = importr(\"fixest\")\nstats = importr(\"stats\")\nbroom = importr(\"broom\")\n\n# IPython magic commands for autoreloading\n%load_ext autoreload\n%autoreload 2\n\n# Get data using pyfixest\ndata = pf.get_data(model=\"Feols\", N=10_000, seed=99292)\n```\n:::\n\n\n## Ordinary Least Squares (OLS)\n\n### IID Inference\n\nFirst, we estimate a model via `pyfixest. We compute \"iid\" standard errors.\n\n::: {#0ffaf790 .cell execution_count=2}\n``` {.python .cell-code}\nfit = pf.feols(fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov=\"iid\")\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n\n            <div id=\"O8A190\"></div>\n            <script type=\"text/javascript\" data-lets-plot-script=\"library\">\n                if(!window.letsPlotCallQueue) {\n                    window.letsPlotCallQueue = [];\n                }; \n                window.letsPlotCall = function(f) {\n                    window.letsPlotCallQueue.push(f);\n                };\n                (function() {\n                    var script = document.createElement(\"script\");\n                    script.type = \"text/javascript\";\n                    script.src = \"https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.7.3/js-package/distr/lets-plot.min.js\";\n                    script.onload = function() {\n                        window.letsPlotCall = function(f) {f();};\n                        window.letsPlotCallQueue.forEach(function(f) {f();});\n                        window.letsPlotCallQueue = [];\n                        \n                    };\n                    script.onerror = function(event) {\n                        window.letsPlotCall = function(f) {};    // noop\n                        window.letsPlotCallQueue = [];\n                        var div = document.createElement(\"div\");\n                        div.style.color = 'darkred';\n                        div.textContent = 'Error loading Lets-Plot JS';\n                        document.getElementById(\"O8A190\").appendChild(div);\n                    };\n                    var e = document.getElementById(\"O8A190\");\n                    e.appendChild(script);\n                })()\n            </script>\n            \n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n\n            <div id=\"bPXX5q\"></div>\n            <script type=\"text/javascript\" data-lets-plot-script=\"library\">\n                if(!window.letsPlotCallQueue) {\n                    window.letsPlotCallQueue = [];\n                }; \n                window.letsPlotCall = function(f) {\n                    window.letsPlotCallQueue.push(f);\n                };\n                (function() {\n                    var script = document.createElement(\"script\");\n                    script.type = \"text/javascript\";\n                    script.src = \"https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.7.3/js-package/distr/lets-plot.min.js\";\n                    script.onload = function() {\n                        window.letsPlotCall = function(f) {f();};\n                        window.letsPlotCallQueue.forEach(function(f) {f();});\n                        window.letsPlotCallQueue = [];\n                        \n                    };\n                    script.onerror = function(event) {\n                        window.letsPlotCall = function(f) {};    // noop\n                        window.letsPlotCallQueue = [];\n                        var div = document.createElement(\"div\");\n                        div.style.color = 'darkred';\n                        div.textContent = 'Error loading Lets-Plot JS';\n                        document.getElementById(\"bPXX5q\").appendChild(div);\n                    };\n                    var e = document.getElementById(\"bPXX5q\");\n                    e.appendChild(script);\n                })()\n            </script>\n            \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nOMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.\n```\n:::\n:::\n\n\nWe estimate the same model with weights:\n\n::: {#5d3b6517 .cell execution_count=3}\n``` {.python .cell-code}\nfit_weights = pf.feols(\n    fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, weights=\"weights\", vcov=\"iid\"\n)\n```\n:::\n\n\nVia `r-fixest` and `rpy2`, we get\n\n::: {#6460fa7a .cell execution_count=4}\n``` {.python .cell-code}\nr_fit = fixest.feols(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    vcov=\"iid\",\n)\n\nr_fit_weights = fixest.feols(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    weights=ro.Formula(\"~weights\"),\n    vcov=\"iid\",\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\n```\n:::\n:::\n\n\n    R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\n    R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\n\n\nLet's compare how close the covariance matrices are:\n\n::: {#52ddc127 .cell execution_count=5}\n``` {.python .cell-code}\nfit_vcov = fit._vcov\nr_vcov = stats.vcov(r_fit)\nfit_vcov - r_vcov\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\narray([[-8.13151629e-19, -8.29248564e-22],\n       [-8.29662154e-22, -1.42301535e-19]])\n```\n:::\n:::\n\n\nAnd for WLS:\n\n::: {#cc19813b .cell execution_count=6}\n``` {.python .cell-code}\nfit_weights._vcov - stats.vcov(r_fit_weights)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\narray([[ 1.73472348e-18, -1.90582413e-21],\n       [-1.90582413e-21, -1.52465931e-19]])\n```\n:::\n:::\n\n\nWe conclude by comparing all estimation results via the `tidy` methods:\n\n::: {#f5d49f2d .cell execution_count=7}\n``` {.python .cell-code}\nfit.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>0.112019</td>\n      <td>0.017042</td>\n      <td>6.572948</td>\n      <td>5.181855e-11</td>\n      <td>0.078612</td>\n      <td>0.145425</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>0.732788</td>\n      <td>0.004621</td>\n      <td>158.578261</td>\n      <td>0.000000e+00</td>\n      <td>0.723730</td>\n      <td>0.741846</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#81623e40 .cell execution_count=8}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(r_fit)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>0.112019</td>\n      <td>0.017042</td>\n      <td>6.572948</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>0.732788</td>\n      <td>0.004621</td>\n      <td>158.578261</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#74cef1c1 .cell execution_count=9}\n``` {.python .cell-code}\nfit_weights.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>0.123687</td>\n      <td>0.016975</td>\n      <td>7.286200</td>\n      <td>3.432810e-13</td>\n      <td>0.090411</td>\n      <td>0.156962</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>0.732244</td>\n      <td>0.004610</td>\n      <td>158.844322</td>\n      <td>0.000000e+00</td>\n      <td>0.723207</td>\n      <td>0.741280</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#f964927f .cell execution_count=10}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(r_fit_weights)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>0.123687</td>\n      <td>0.016975</td>\n      <td>7.2862</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>0.732244</td>\n      <td>0.00461</td>\n      <td>158.844322</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Heteroskedastic Errors\n\nWe repeat the same exercise with heteroskedastic (HC1) errors:\n\n::: {#864a758d .cell execution_count=11}\n``` {.python .cell-code}\nfit = pf.feols(fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov=\"hetero\")\nfit_weights = pf.feols(\n    fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov=\"hetero\", weights=\"weights\"\n)\n```\n:::\n\n\n::: {#63532eb6 .cell execution_count=12}\n``` {.python .cell-code}\nr_fit = fixest.feols(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    vcov=\"hetero\",\n)\n\nr_fit_weights = fixest.feols(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    weights=ro.Formula(\"~weights\"),\n    vcov=\"hetero\",\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\n```\n:::\n:::\n\n\nAs before, we compare the variance covariance matrices:\n\n::: {#e996c400 .cell execution_count=13}\n``` {.python .cell-code}\nfit._vcov - stats.vcov(r_fit)\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```\narray([[-1.08099836e-14, -1.51721960e-15],\n       [-1.51721966e-15, -3.55912741e-15]])\n```\n:::\n:::\n\n\n::: {#f4ec15c2 .cell execution_count=14}\n``` {.python .cell-code}\nfit_weights._vcov - stats.vcov(r_fit_weights)\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\narray([[-7.68580078e-15,  2.60362427e-15],\n       [ 2.60362448e-15, -1.52111871e-15]])\n```\n:::\n:::\n\n\nWe conclude by comparing all estimation results via the `tidy` methods:\n\n::: {#d6c704f6 .cell execution_count=15}\n``` {.python .cell-code}\nfit.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>0.112019</td>\n      <td>0.017105</td>\n      <td>6.548962</td>\n      <td>6.082002e-11</td>\n      <td>0.078490</td>\n      <td>0.145548</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>0.732788</td>\n      <td>0.004579</td>\n      <td>160.036098</td>\n      <td>0.000000e+00</td>\n      <td>0.723812</td>\n      <td>0.741763</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#47e710bc .cell execution_count=16}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(r_fit)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>0.112019</td>\n      <td>0.017105</td>\n      <td>6.548962</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>0.732788</td>\n      <td>0.004579</td>\n      <td>160.036098</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#905999a2 .cell execution_count=17}\n``` {.python .cell-code}\nfit_weights.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>0.123687</td>\n      <td>0.019470</td>\n      <td>6.352618</td>\n      <td>2.210045e-10</td>\n      <td>0.085521</td>\n      <td>0.161852</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>0.732244</td>\n      <td>0.005169</td>\n      <td>141.653304</td>\n      <td>0.000000e+00</td>\n      <td>0.722111</td>\n      <td>0.742376</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#90f02a55 .cell execution_count=18}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(r_fit_weights)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>0.123687</td>\n      <td>0.01947</td>\n      <td>6.352618</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>0.732244</td>\n      <td>0.005169</td>\n      <td>141.653304</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Cluster-Robust Errors\n\nWe conclude with cluster robust errors.\n\n::: {#46c676aa .cell execution_count=19}\n``` {.python .cell-code}\nfit = pf.feols(fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov={\"CRV1\": \"f1\"})\nfit_weights = pf.feols(\n    fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov={\"CRV1\": \"f1\"}, weights=\"weights\"\n)\n\nr_fit = fixest.feols(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    vcov=ro.Formula(\"~f1\"),\n)\nr_fit_weights = fixest.feols(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    weights=ro.Formula(\"~weights\"),\n    vcov=ro.Formula(\"~f1\"),\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTE: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n\n```\n:::\n:::\n\n\n::: {#b3e59652 .cell execution_count=20}\n``` {.python .cell-code}\nfit._vcov - stats.vcov(r_fit)\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\narray([[ 2.86078127e-14, -4.95778718e-15],\n       [-4.95778718e-15, -9.43706512e-16]])\n```\n:::\n:::\n\n\n::: {#c546e133 .cell execution_count=21}\n``` {.python .cell-code}\nfit_weights._vcov - stats.vcov(r_fit_weights)\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```\narray([[ 7.00020554e-15,  1.26505590e-14],\n       [ 1.26505590e-14, -1.11286577e-16]])\n```\n:::\n:::\n\n\nWe conclude by comparing all estimation results via the `tidy` methods:\n\n::: {#994ad239 .cell execution_count=22}\n``` {.python .cell-code}\nfit.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>0.112019</td>\n      <td>0.015865</td>\n      <td>7.060624</td>\n      <td>4.823750e-09</td>\n      <td>0.080152</td>\n      <td>0.143885</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>0.732788</td>\n      <td>0.004490</td>\n      <td>163.215618</td>\n      <td>0.000000e+00</td>\n      <td>0.723770</td>\n      <td>0.741806</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#fa1c3688 .cell execution_count=23}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(r_fit)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>0.112019</td>\n      <td>0.015865</td>\n      <td>7.060624</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>0.732788</td>\n      <td>0.00449</td>\n      <td>163.215618</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#171eab6e .cell execution_count=24}\n``` {.python .cell-code}\nfit_weights.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>0.123687</td>\n      <td>0.018368</td>\n      <td>6.733633</td>\n      <td>1.566958e-08</td>\n      <td>0.086792</td>\n      <td>0.160581</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>0.732244</td>\n      <td>0.005266</td>\n      <td>139.062210</td>\n      <td>0.000000e+00</td>\n      <td>0.721667</td>\n      <td>0.742820</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#72c7922b .cell execution_count=25}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(r_fit_weights)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>0.123687</td>\n      <td>0.018368</td>\n      <td>6.733633</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>0.732244</td>\n      <td>0.005266</td>\n      <td>139.06221</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Poisson Regression\n\n::: {#b0aec9e8 .cell execution_count=26}\n``` {.python .cell-code}\ndata = pf.get_data(model=\"Fepois\")\n```\n:::\n\n\n::: {#7b27424c .cell execution_count=27}\n``` {.python .cell-code}\nfit_iid = pf.fepois(fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov=\"iid\", iwls_tol=1e-10)\nfit_hetero = pf.fepois(\n    fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov=\"hetero\", iwls_tol=1e-10\n)\nfit_crv = pf.fepois(\n    fml=\"Y ~ X1 + X2 | f1 + f2\", data=data, vcov={\"CRV1\": \"f1\"}, iwls_tol=1e-10\n)\n\nfit_r_iid = fixest.fepois(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    vcov=\"iid\",\n)\n\nfit_r_hetero = fixest.fepois(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    vcov=\"hetero\",\n)\n\nfit_r_crv = fixest.fepois(\n    ro.Formula(\"Y ~ X1 + X2 | f1 + f2\"),\n    data=data,\n    vcov=ro.Formula(\"~f1\"),\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/model_matrix_fixest_.py:221: UserWarning: 2 singleton fixed effect(s) detected. These observations are dropped from the model.\n  warnings.warn(\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/model_matrix_fixest_.py:221: UserWarning: 2 singleton fixed effect(s) detected. These observations are dropped from the model.\n  warnings.warn(\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/model_matrix_fixest_.py:221: UserWarning: 2 singleton fixed effect(s) detected. These observations are dropped from the model.\n  warnings.warn(\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTES: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n       1/1 fixed-effects (2 observations) removed because of only 0 outcomes or singletons.\n\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTES: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n       1/1 fixed-effects (2 observations) removed because of only 0 outcomes or singletons.\n\nWARNING:rpy2.rinterface_lib.callbacks:R[write to console]: NOTES: 3 observations removed because of NA values (LHS: 1, RHS: 1, Fixed-effects: 1).\n       1/1 fixed-effects (2 observations) removed because of only 0 outcomes or singletons.\n\n```\n:::\n:::\n\n\n::: {#08f074ed .cell execution_count=28}\n``` {.python .cell-code}\nfit_iid._vcov - stats.vcov(fit_r_iid)\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```\narray([[ 1.28462055e-08, -6.97520098e-10],\n       [-6.97520098e-10,  1.80739283e-09]])\n```\n:::\n:::\n\n\n::: {#ba87e1de .cell execution_count=29}\n``` {.python .cell-code}\nfit_hetero._vcov - stats.vcov(fit_r_hetero)\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\narray([[ 2.31981933e-08, -7.87424679e-10],\n       [-7.87424679e-10,  3.27120926e-09]])\n```\n:::\n:::\n\n\n::: {#6fc9ca33 .cell execution_count=30}\n``` {.python .cell-code}\nfit_crv._vcov - stats.vcov(fit_r_crv)\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```\narray([[ 1.63339756e-08, -1.24809110e-10],\n       [-1.24809110e-10,  3.27895328e-09]])\n```\n:::\n:::\n\n\nWe conclude by comparing all estimation results via the `tidy` methods:\n\n::: {#5087ff99 .cell execution_count=31}\n``` {.python .cell-code}\nfit_iid.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>-0.006591</td>\n      <td>0.042025</td>\n      <td>-0.156836</td>\n      <td>0.875374</td>\n      <td>-0.088959</td>\n      <td>0.075777</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>-0.014924</td>\n      <td>0.011336</td>\n      <td>-1.316520</td>\n      <td>0.188000</td>\n      <td>-0.037142</td>\n      <td>0.007294</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#4e36f3d8 .cell execution_count=32}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(fit_r_iid)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>-0.006591</td>\n      <td>0.042025</td>\n      <td>-0.156836</td>\n      <td>0.875374</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>-0.014924</td>\n      <td>0.011336</td>\n      <td>-1.316529</td>\n      <td>0.187996</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#cbdd98bb .cell execution_count=33}\n``` {.python .cell-code}\nfit_hetero.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>-0.006591</td>\n      <td>0.040363</td>\n      <td>-0.163297</td>\n      <td>0.870284</td>\n      <td>-0.085700</td>\n      <td>0.072518</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>-0.014924</td>\n      <td>0.010828</td>\n      <td>-1.378277</td>\n      <td>0.168118</td>\n      <td>-0.036146</td>\n      <td>0.006298</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#558772d5 .cell execution_count=34}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(fit_r_hetero)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>-0.006591</td>\n      <td>0.040362</td>\n      <td>-0.163298</td>\n      <td>0.870284</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>-0.014924</td>\n      <td>0.010828</td>\n      <td>-1.378296</td>\n      <td>0.168112</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#43c18e1c .cell execution_count=35}\n``` {.python .cell-code}\nfit_crv.tidy()\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Estimate</th>\n      <th>Std. Error</th>\n      <th>t value</th>\n      <th>Pr(&gt;|t|)</th>\n      <th>2.5%</th>\n      <th>97.5%</th>\n    </tr>\n    <tr>\n      <th>Coefficient</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>X1</th>\n      <td>-0.006591</td>\n      <td>0.035302</td>\n      <td>-0.186705</td>\n      <td>0.851892</td>\n      <td>-0.075782</td>\n      <td>0.062600</td>\n    </tr>\n    <tr>\n      <th>X2</th>\n      <td>-0.014924</td>\n      <td>0.010468</td>\n      <td>-1.425726</td>\n      <td>0.153947</td>\n      <td>-0.035440</td>\n      <td>0.005592</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#035c8474 .cell execution_count=36}\n``` {.python .cell-code}\npd.DataFrame(broom.tidy_fixest(fit_r_crv)).T\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>X1</td>\n      <td>-0.006591</td>\n      <td>0.035302</td>\n      <td>-0.186706</td>\n      <td>0.851891</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>X2</td>\n      <td>-0.014924</td>\n      <td>0.010467</td>\n      <td>-1.425747</td>\n      <td>0.153941</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "compare-fixest-pyfixest_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}