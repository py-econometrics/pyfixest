{
  "hash": "21e99c62c0cc0e829b3c8bfb633fde68",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Quantile Regression\"\nformat:\n  html:\n    html-table-processing: none\ntoc: true\ntoc-title: \"On this page\"\ntoc-location: left\nfreeze: auto\n---\n\nPyFixest now experimentally supports quantile regression!\n\n::: {#4239b7a1 .cell execution_count=1}\n``` {.python .cell-code}\n%load_ext autoreload\n\nimport pyfixest as pf\ndata = pf.get_data()\n```\n:::\n\n\n## Basic Example\n\nJust as in `statsmodels`, the function that runs a quantile regression is `quantreg()`.\n\nBelow, we loop over 10 different quantiles.\n\n::: {#f28b3eeb .cell execution_count=2}\n``` {.python .cell-code}\n%%capture\nfits = pf.quantreg(\n  fml = \"Y~X1 + X2\",\n  data = data,\n  quantile=[0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]\n)\n```\n:::\n\n\nWe can inspect the quantile regression results using the dedicated `qplot()` function.\n\n::: {#33552aae .cell execution_count=3}\n``` {.python .cell-code}\npf.qplot(fits, nrow = 2)\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\n(<Figure size 960x576 with 4 Axes>,\n array([<Axes: title={'center': 'Intercept'}, xlabel='Quantile', ylabel='Coefficient (95 % CI)'>,\n        <Axes: title={'center': 'X1'}, xlabel='Quantile', ylabel='Coefficient (95 % CI)'>,\n        <Axes: title={'center': 'X2'}, xlabel='Quantile', ylabel='Coefficient (95 % CI)'>,\n        <Axes: >], dtype=object))\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](quantile-regression_files/figure-html/cell-4-output-2.png){width=949 height=564}\n:::\n:::\n\n\nWe observe some heterogeneity in the intercept, but all other variants are homogeneous across users.\n\n## Solvers\n\nBy default, `pf.quantreg` uses an interior-point solver as in [Koenker and Ng (2004)](http://www.econ.uiuc.edu/~roger/research/sparse/fn3.pdf) (`methd = \"fn\"`). This is different to e.g. `statsmodels`, which implements an iterated weighted least squares solver.\n\nFor big data sets with many observations, it is often sensible to use an interior-point solver with pre-processing (as in [Portnoy and Koenker (1997)](https://experts.illinois.edu/en/publications/the-gaussian-hare-and-the-laplacian-tortoise-computability-of-squ), see [Chernozhukov et al (2019)](https://arxiv.org/abs/1909.05782) for details), which can speed up the estimation time significantly. Because the pre-processing step requires taking a random sample, the method assumes that observations are independent. Additionally, for the purpose of reproducibility, it is advisable to set a seed.\n\nYou can access the \"preprocessing frisch-newton\" algorithm by setting the `method` argument to `\"pfn\"`:\n\n::: {#b93b237e .cell execution_count=4}\n``` {.python .cell-code}\n%%capture\nfit_fn = pf.quantreg(\n  fml = \"Y ~ X1\",\n  method = \"fn\",     # standard frisch newton interior point solver\n  data = data,\n)\nfit_pfn = pf.quantreg(\n  fml = \"Y ~ X1\",\n  method = \"pfn\",   # standard frisch newton interior point solver with pre-processing\n  seed = 92,         # set a seed for reproducibility\n  data = data,\n)\n\npf.etable([fit_fn, fit_pfn])\n```\n:::\n\n\n## Quantile Regression Process\n\nInstead of running multiple independent quantile regression via a for-loop, the literature on quantile regression has developed multiple algorithms to speed up the \"quantile regression process\". Two such algorithms are described in detail in Chernozhukov, Fernandez-Val and Melly (2019) and are implemented in PyFixest. They can be accessed via the `multi_method` argument, and both can significantly speed up estimation time of the full quantile regression process.\n\n::: {#f1d66ce9 .cell execution_count=5}\n``` {.python .cell-code}\nfml = \"Y~X1\"\nmethod = \"pfn\"\nseed = 929\nquantiles = [0.1, 0.5, 0.9]\n\nfit_multi1 = pf.quantreg(\n  fml = fml,\n  data = data,\n  method = method,\n  multi_method = \"cfm1\",  # this is algorithm 2 in CFM, the 1rst algorithm for the full qr process\n  seed = seed,\n  quantile = quantiles,\n)\n\nfit_multi2 = pf.quantreg(\n  fml = fml,\n  data = data,\n  method = method,\n  multi_method = \"cfm2\",  # this is algorithm 3 in CFM, the 2nd algorithm for the full qr process\n  seed = seed,\n  quantile = quantiles\n)\n\npf.etable(fit_multi1.to_list() +  fit_multi2.to_list())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:77: FutureWarning: \n           The Quantile Regression implementation is experimental and may change in future releases.\n           But mostly, we expect the API to remain unchanged.\n           \n  warnings.warn(\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:77: FutureWarning: \n           The Quantile Regression implementation is experimental and may change in future releases.\n           But mostly, we expect the API to remain unchanged.\n           \n  warnings.warn(\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div id=\"wpsqukgyzs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n#wpsqukgyzs table {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#wpsqukgyzs thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#wpsqukgyzs p { margin: 0; padding: 0; }\n #wpsqukgyzs .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }\n #wpsqukgyzs .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #wpsqukgyzs .gt_title { color: #333333; font-size: 16px; font-weight: initial; padding-top: 6px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #wpsqukgyzs .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 5px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #wpsqukgyzs .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #wpsqukgyzs .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #wpsqukgyzs .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #wpsqukgyzs .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 16px; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: bottom; padding-top: 2px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #wpsqukgyzs .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 16px; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #wpsqukgyzs .gt_column_spanner_outer:first-child { padding-left: 0; }\n #wpsqukgyzs .gt_column_spanner_outer:last-child { padding-right: 0; }\n #wpsqukgyzs .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; vertical-align: bottom; padding-top: 2px; padding-bottom: 2px; overflow-x: hidden; display: inline-block; width: 100%; }\n #wpsqukgyzs .gt_spanner_row { border-bottom-style: hidden; }\n #wpsqukgyzs .gt_group_heading { padding-top: 0px; padding-bottom: 0px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 0.25px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: white; border-right-style: none; border-right-width: 1px; border-right-color: white; vertical-align: middle; text-align: left; }\n #wpsqukgyzs .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; border-top-style: solid; border-top-width: 0.25px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; vertical-align: middle; }\n #wpsqukgyzs .gt_from_md> :first-child { margin-top: 0; }\n #wpsqukgyzs .gt_from_md> :last-child { margin-bottom: 0; }\n #wpsqukgyzs .gt_row { padding-top: 2px; padding-bottom: 2px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: middle; overflow-x: hidden; }\n #wpsqukgyzs .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 16px; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #wpsqukgyzs .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #wpsqukgyzs .gt_row_group_first td { border-top-width: 0.25px; }\n #wpsqukgyzs .gt_row_group_first th { border-top-width: 0.25px; }\n #wpsqukgyzs .gt_striped { color: #333333; background-color: #F4F4F4; }\n #wpsqukgyzs .gt_table_body { border-top-style: solid; border-top-width: 0px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }\n #wpsqukgyzs .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }\n #wpsqukgyzs .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }\n #wpsqukgyzs .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }\n #wpsqukgyzs .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #wpsqukgyzs .gt_sourcenote { font-size: 10px; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #wpsqukgyzs .gt_left { text-align: left; }\n #wpsqukgyzs .gt_center { text-align: center; }\n #wpsqukgyzs .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #wpsqukgyzs .gt_font_normal { font-weight: normal; }\n #wpsqukgyzs .gt_font_bold { font-weight: bold; }\n #wpsqukgyzs .gt_font_italic { font-style: italic; }\n #wpsqukgyzs .gt_super { font-size: 65%; }\n #wpsqukgyzs .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #wpsqukgyzs .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings gt_spanner_row\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n  <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"6\" scope=\"colgroup\" id=\"Y\">\n    <span class=\"gt_column_spanner\">Y</span>\n  </th>\n</tr>\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"0\">(1)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"1\">(2)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"2\">(3)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"3\">(4)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"4\">(5)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"5\">(6)</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"7\">coef</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">X1</th>\n    <td class=\"gt_row gt_center\">-0.96*** <br> (0.161)</td>\n    <td class=\"gt_row gt_center\">-1.091*** <br> (0.107)</td>\n    <td class=\"gt_row gt_center\">-0.796*** <br> (0.121)</td>\n    <td class=\"gt_row gt_center\">-1.091*** <br> (0.161)</td>\n    <td class=\"gt_row gt_center\">-1.091*** <br> (0.107)</td>\n    <td class=\"gt_row gt_center\">-1.091*** <br> (0.121)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Intercept</th>\n    <td class=\"gt_row gt_center\">-1.935*** <br> (0.231)</td>\n    <td class=\"gt_row gt_center\">1.024*** <br> (0.145)</td>\n    <td class=\"gt_row gt_center\">3.505*** <br> (0.157)</td>\n    <td class=\"gt_row gt_center\">-1.354*** <br> (0.231)</td>\n    <td class=\"gt_row gt_center\">1.024*** <br> (0.145)</td>\n    <td class=\"gt_row gt_center\">3.403*** <br> (0.157)</td>\n  </tr>\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"7\">stats</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Observations</th>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">R<sup>2</sup></th>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n  </tr>\n</tbody>\n  <tfoot class=\"gt_sourcenotes\">\n  \n  <tr>\n    <td class=\"gt_sourcenote\" colspan=\"7\">Significance levels: * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001. Format of coefficient cell: Coefficient   (Std. Error)</td>\n  </tr>\n\n</tfoot>\n\n</table>\n\n</div>\n        \n```\n:::\n:::\n\n\nNote that the first method `cfm1` is exactly identical to running separate regressions per quantile, while the second method `cfm2` is only **asymptotically** identical.\n\nYou can combine different estimation `method`'s with different `multi_methods`:\n\n::: {#05438b66 .cell execution_count=6}\n``` {.python .cell-code}\nfit_multi2a = pf.quantreg(\n  fml = \"Y~X1\",\n  data = data,\n  method = \"fn\",\n  multi_method = \"cfm1\",\n  seed = 233,\n  quantile = [0.25, 0.75]\n)\n\nfit_multi2b = pf.quantreg(\n  fml = \"Y~X1\",\n  data = data,\n  method = \"pfn\",\n  multi_method = \"cfm1\",\n  seed = 233,\n  quantile = [0.25, 0.75]\n)\n\npf.etable(fit_multi2a.to_list() +  fit_multi2b.to_list())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:77: FutureWarning: \n           The Quantile Regression implementation is experimental and may change in future releases.\n           But mostly, we expect the API to remain unchanged.\n           \n  warnings.warn(\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:77: FutureWarning: \n           The Quantile Regression implementation is experimental and may change in future releases.\n           But mostly, we expect the API to remain unchanged.\n           \n  warnings.warn(\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div id=\"xyjmmkfmjh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n#xyjmmkfmjh table {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#xyjmmkfmjh thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#xyjmmkfmjh p { margin: 0; padding: 0; }\n #xyjmmkfmjh .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }\n #xyjmmkfmjh .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #xyjmmkfmjh .gt_title { color: #333333; font-size: 16px; font-weight: initial; padding-top: 6px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #xyjmmkfmjh .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 5px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #xyjmmkfmjh .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #xyjmmkfmjh .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #xyjmmkfmjh .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #xyjmmkfmjh .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 16px; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: bottom; padding-top: 2px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #xyjmmkfmjh .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 16px; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #xyjmmkfmjh .gt_column_spanner_outer:first-child { padding-left: 0; }\n #xyjmmkfmjh .gt_column_spanner_outer:last-child { padding-right: 0; }\n #xyjmmkfmjh .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; vertical-align: bottom; padding-top: 2px; padding-bottom: 2px; overflow-x: hidden; display: inline-block; width: 100%; }\n #xyjmmkfmjh .gt_spanner_row { border-bottom-style: hidden; }\n #xyjmmkfmjh .gt_group_heading { padding-top: 0px; padding-bottom: 0px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 0.25px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: white; border-right-style: none; border-right-width: 1px; border-right-color: white; vertical-align: middle; text-align: left; }\n #xyjmmkfmjh .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; border-top-style: solid; border-top-width: 0.25px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.25px; border-bottom-color: black; vertical-align: middle; }\n #xyjmmkfmjh .gt_from_md> :first-child { margin-top: 0; }\n #xyjmmkfmjh .gt_from_md> :last-child { margin-bottom: 0; }\n #xyjmmkfmjh .gt_row { padding-top: 2px; padding-bottom: 2px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: middle; overflow-x: hidden; }\n #xyjmmkfmjh .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 16px; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #xyjmmkfmjh .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #xyjmmkfmjh .gt_row_group_first td { border-top-width: 0.25px; }\n #xyjmmkfmjh .gt_row_group_first th { border-top-width: 0.25px; }\n #xyjmmkfmjh .gt_striped { color: #333333; background-color: #F4F4F4; }\n #xyjmmkfmjh .gt_table_body { border-top-style: solid; border-top-width: 0px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }\n #xyjmmkfmjh .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }\n #xyjmmkfmjh .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }\n #xyjmmkfmjh .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }\n #xyjmmkfmjh .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #xyjmmkfmjh .gt_sourcenote { font-size: 10px; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #xyjmmkfmjh .gt_left { text-align: left; }\n #xyjmmkfmjh .gt_center { text-align: center; }\n #xyjmmkfmjh .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #xyjmmkfmjh .gt_font_normal { font-weight: normal; }\n #xyjmmkfmjh .gt_font_bold { font-weight: bold; }\n #xyjmmkfmjh .gt_font_italic { font-style: italic; }\n #xyjmmkfmjh .gt_super { font-size: 65%; }\n #xyjmmkfmjh .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #xyjmmkfmjh .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings gt_spanner_row\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n  <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"4\" scope=\"colgroup\" id=\"Y\">\n    <span class=\"gt_column_spanner\">Y</span>\n  </th>\n</tr>\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"0\">(1)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"1\">(2)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"2\">(3)</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"3\">(4)</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"5\">coef</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">X1</th>\n    <td class=\"gt_row gt_center\">-0.851*** <br> (0.109)</td>\n    <td class=\"gt_row gt_center\">-1.017*** <br> (0.126)</td>\n    <td class=\"gt_row gt_center\">-0.851*** <br> (0.109)</td>\n    <td class=\"gt_row gt_center\">-1.017*** <br> (0.126)</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Intercept</th>\n    <td class=\"gt_row gt_center\">-0.782*** <br> (0.132)</td>\n    <td class=\"gt_row gt_center\">2.495*** <br> (0.169)</td>\n    <td class=\"gt_row gt_center\">-0.782*** <br> (0.132)</td>\n    <td class=\"gt_row gt_center\">2.495*** <br> (0.169)</td>\n  </tr>\n  <tr class=\"gt_group_heading_row\">\n    <th class=\"gt_group_heading\" colspan=\"5\">stats</th>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">Observations</th>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n    <td class=\"gt_row gt_center\">998</td>\n  </tr>\n  <tr>\n    <th class=\"gt_row gt_left gt_stub\">R<sup>2</sup></th>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n    <td class=\"gt_row gt_center\">-</td>\n  </tr>\n</tbody>\n  <tfoot class=\"gt_sourcenotes\">\n  \n  <tr>\n    <td class=\"gt_sourcenote\" colspan=\"5\">Significance levels: * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001. Format of coefficient cell: Coefficient   (Std. Error)</td>\n  </tr>\n\n</tfoot>\n\n</table>\n\n</div>\n        \n```\n:::\n:::\n\n\n## Inference\n\nBy default, the `\"iid\", \"hetero\"` and cluster robust variance estimators implement (sandwich) estimators as in [Powell (1991)](https://econpapers.repec.org/paper/attwimass/8818.htm), using a uniform kernel to estimate the \"sparsity\".\n\nThe cluster robust estimator follows Parente & Santos Silva. See this [slide set](https://www.stata.com/meeting/uk15/abstracts/materials/uk15_santossilva.pdf) or the [Journal of Econometrics paper](https://repository.essex.ac.uk/8976/1/dp728.pdf) for details.\n\nAdditionally, `pf.quantreg` supports the `\"nid\"` (\"non-iid\") estimator from [Hendricks and Koenker (1991)](https://www.tandfonline.com/doi/abs/10.1080/01621459.1992.10475175), which uses a linear approximation of the conditional quantile function.\n\n::: {#e1f06d1c .cell execution_count=7}\n``` {.python .cell-code}\nfit_nid = pf.quantreg(\"Y ~ X1 + X2 + f1\", data = data, quantile = 0.5, vcov = \"nid\")\nfit_crv = pf.quantreg(\"Y ~ X1 + X2 + f1\", data = data, quantile = 0.5, vcov = {\"CRV1\": \"f1\"})\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:77: FutureWarning: \n           The Quantile Regression implementation is experimental and may change in future releases.\n           But mostly, we expect the API to remain unchanged.\n           \n  warnings.warn(\n/Users/afischer/Documents/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:77: FutureWarning: \n           The Quantile Regression implementation is experimental and may change in future releases.\n           But mostly, we expect the API to remain unchanged.\n           \n  warnings.warn(\n```\n:::\n:::\n\n\n## Performance\n\nHere we benchmark the performance of the solvers accessible via the `method` and `multi_method` arguments.\n\n### Different Solvers\n\nTba.\n\n### Quantile Regression Process\n\nWe fit a quantile regression process on $q = 0.1, 0.2, ..., 0.9$ quantiles and vary sample size and number of covariates. We test pyfixest's implementation of the quantile regression process against a \"naive\" for loop implementation via `statsmodels`. We can see that both `multi_method = \"cmf1\"` and `multi_method = \"cmf2\"` outperform\nthe for-loop strategy for large problems. Note that the plot is in log-scale!\n\n![](figures/quantreg_benchmarks.png)\n\n# Literature\n\n- Victor Chernozhukov, Iván Fernández-Val, Blaise Melly (2019): Fast Algorithms for the Quantile Regression Process - [link](https://arxiv.org/abs/1909.05782)\n- Hendricks & Koenker (1991): Hierarchical spline models for conditional quantiles and the demand for electricity - [link](https://www.tandfonline.com/doi/abs/10.1080/01621459.1992.10475175)\n- Koenker and Ng (2004): A Frisch-Newton Algorithm for Sparse Quantile Regression - [link](http://www.econ.uiuc.edu/~roger/research/sparse/fn3.pdf)\n- Parente & Santos Silva (2015): Quantile Regression with Clustered Data - [link](https://econpapers.repec.org/article/bpjjecome/v_3a5_3ay_3a2016_3ai_3a1_3ap_3a1-15_3an_3a5.htm)\n- Portnoy & Koenker (1997): The gaussian hare and the laplacian tortoise: Computability of squared-error versus absolute-error estimators - [link](https://experts.illinois.edu/en/publications/the-gaussian-hare-and-the-laplacian-tortoise-computability-of-squ)\n- Powell (1991): Estimation of monotonic regression models under quantile restrictions - [link](https://econpapers.repec.org/paper/attwimass/8818.htm)\n\n",
    "supporting": [
      "quantile-regression_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}