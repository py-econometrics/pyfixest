<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>changelog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b9c55ee423fe9b09b80369c068559168.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./pyfixest.html"> 
<span class="menu-text">PyFixest</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./quickstart.html"> 
<span class="menu-text">Quickstart</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./reference/index.html"> 
<span class="menu-text">Function Reference</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./changelog.html" aria-current="page"> 
<span class="menu-text">Changelog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./contributing.html"> 
<span class="menu-text">Contributing</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-learn-more" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Learn more</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-learn-more">    
        <li>
    <a class="dropdown-item" href="./table-layout.html">
 <span class="dropdown-text">Regression Tables and Summary Statistics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./marginaleffects.html">
 <span class="dropdown-text">Hypothesis Testing and Marginal Effects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./difference-in-differences.html">
 <span class="dropdown-text">Difference-in-Differences Estimation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./multiple_testing.html">
 <span class="dropdown-text">Multiple Testing Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./regression_decomposition.html">
 <span class="dropdown-text">Regression Decomposition</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ssc.html">
 <span class="dropdown-text">On Small Sample Corrections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./quantile-regression.html">
 <span class="dropdown-text">Quantile Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./stata-2-pyfixest.html">
 <span class="dropdown-text">Compare Stata &amp; PyFixest</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pyfixest-gpu-cupy.html">
 <span class="dropdown-text">PyFixest on the GPU via CuPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pyfixest_gpu.html">
 <span class="dropdown-text">PyFixest on the GPU via JAX</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources.html">
 <span class="dropdown-text">Other Resources around PyFixest</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./replicating-the-effect.html">
 <span class="dropdown-text">Replicating ‘The Effect’ with PyFixest</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mixtape.html">
 <span class="dropdown-text">Replicating ‘The Mixtape’ with PyFixest</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./brave_true.html">
 <span class="dropdown-text">Replicating ‘Causal Inference for the Brave and True’ with PyFixest</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/py-econometrics/pyfixest/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Changelog</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="c0534854" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.report.utils <span class="im">import</span> rename_categoricals</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pf.get_data()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>fit1 <span class="op">=</span> pf.feols(<span class="st">"Y ~ X1"</span>, data <span class="op">=</span> df)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>fit2 <span class="op">=</span> pf.feols(<span class="st">"Y ~ X1 + X2"</span>, data <span class="op">=</span> df)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>fit3 <span class="op">=</span> pf.feols(<span class="st">"Y ~ X1 + X2 | f1"</span>, data <span class="op">=</span> df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">

            <div id="8ePN3b"></div>
            <script type="text/javascript" data-lets-plot-script="library">
                if(!window.letsPlotCallQueue) {
                    window.letsPlotCallQueue = [];
                }; 
                window.letsPlotCall = function(f) {
                    window.letsPlotCallQueue.push(f);
                };
                (function() {
                    var script = document.createElement("script");
                    script.type = "text/javascript";
                    script.src = "https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.7.3/js-package/distr/lets-plot.min.js";
                    script.onload = function() {
                        window.letsPlotCall = function(f) {f();};
                        window.letsPlotCallQueue.forEach(function(f) {f();});
                        window.letsPlotCallQueue = [];
                        
                    };
                    script.onerror = function(event) {
                        window.letsPlotCall = function(f) {};    // noop
                        window.letsPlotCallQueue = [];
                        var div = document.createElement("div");
                        div.style.color = 'darkred';
                        div.textContent = 'Error loading Lets-Plot JS';
                        document.getElementById("8ePN3b").appendChild(div);
                    };
                    var e = document.getElementById("8ePN3b");
                    e.appendChild(script);
                })()
            </script>
            
</div>
<div class="cell-output cell-output-display">

            <div id="J4no9n"></div>
            <script type="text/javascript" data-lets-plot-script="library">
                if(!window.letsPlotCallQueue) {
                    window.letsPlotCallQueue = [];
                }; 
                window.letsPlotCall = function(f) {
                    window.letsPlotCallQueue.push(f);
                };
                (function() {
                    var script = document.createElement("script");
                    script.type = "text/javascript";
                    script.src = "https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.7.3/js-package/distr/lets-plot.min.js";
                    script.onload = function() {
                        window.letsPlotCall = function(f) {f();};
                        window.letsPlotCallQueue.forEach(function(f) {f();});
                        window.letsPlotCallQueue = [];
                        
                    };
                    script.onerror = function(event) {
                        window.letsPlotCall = function(f) {};    // noop
                        window.letsPlotCallQueue = [];
                        var div = document.createElement("div");
                        div.style.color = 'darkred';
                        div.textContent = 'Error loading Lets-Plot JS';
                        document.getElementById("J4no9n").appendChild(div);
                    };
                    var e = document.getElementById("J4no9n");
                    e.appendChild(script);
                })()
            </script>
            
</div>
</div>
<section id="pyfixest-0.40.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.40.0">PyFixest 0.40.0</h2>
<section id="breaking-changes-for-compatibility-with-fixest-0.13" class="level3">
<h3 class="anchored" data-anchor-id="breaking-changes-for-compatibility-with-fixest-0.13">Breaking Changes for compatibility with <code>fixest</code> 0.13</h3>
<p><code>fixest</code> 0.13 has recently been released to CRAN, with a range of breaking changes. We are following these in pyfixet 0.40.0.</p>
<ul>
<li>The default inference method is now always “iid”. Before, both <code>fixest</code> and <code>pyfixest</code> would default to cluster by the first fixest effect in the presence of fixed effect.</li>
<li>The arguments of the <code>pf.ssc()</code> functions have been renamed: <code>adj</code> becomes <code>k_adj</code>, <code>fixef_k</code> becomes <code>k_fixef</code>, <code>cluster_df</code> becomes <code>G_df</code>, and <code>cluster_adj</code> becomes <code>G_adj</code>. Backwards compatibility is ensured.</li>
<li><code>fixest</code> no longer applies the <code>G/(G-1)</code> small sample correction for heteroskedastic errors. The argument is now only relevant for cluster robust errors.</li>
<li>If the <code>k_adj</code> arg is set to <code>True</code> with heteroskedastic errors, the applied small sample correction now is <code>N / (N-k)</code> and no longer <code>(N-1) / (N-df_k)</code>, as was previously the case and is still the case for iid and cluster robust errors.</li>
<li>The <code>k_fixef</code> option <code>"nested"</code> has been renamed to <code>"nonnested"</code>.</li>
<li>The <code>fixef_rm</code> argument is changed from default <code>"none"</code> to <code>"singleton"</code> for all estimation functions. This has no impact on point estimates, but might change inference due to a smaller number of observations in the degree of freedom correction.</li>
<li>The multicollinearity default tolerance has been reduced from 1e-10 to 1e-09.</li>
<li>The attribute <code>_dof_k</code> has been renamed to <code>_df_k</code>.</li>
</ul>
<p>Other related changes: - The arguments to adjust the small samples for the <code>wildboottest</code> methods have been renamed to <code>k_adj</code> and <code>G_adj</code>.</p>
</section>
<section id="moved-to-pixi.toml-and-install-from-conda-forge" class="level3">
<h3 class="anchored" data-anchor-id="moved-to-pixi.toml-and-install-from-conda-forge">Moved to <code>pixi.toml</code> and install from conda-forge</h3>
<p>We have been using pixi as our package manager for a while and are moving from a <code>pyproject.toml</code> to using a <code>pixi.toml</code> for specifying dependencies. We also install all package by default from the free and open source conda-forge. Because of some environment resolution challenges around an old version of <code>rpy2</code>that we need for testing <code>pyfixest</code> against <code>fixest</code>, we temporarily have dropped support for the dev and docs environments for windows. A fix is work in progress.</p>
</section>
</section>
<section id="new-features" class="level2">
<h2 class="anchored" data-anchor-id="new-features">New Features</h2>
<section id="cupy-and-scipy-backends-via-lsmr" class="level3">
<h3 class="anchored" data-anchor-id="cupy-and-scipy-backends-via-lsmr">CuPy and SciPy Backends via LSMR</h3>
<p>We add CuPy and SciPy Backend to run the demeaning algorithm on the GPU via the sparse LSMR solver. For problems where the standard demeaner struggles to converge, this strategy can lead to significant speedups if paired with a GPU.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://raw.githubusercontent.com/py-econometrics/pyfixest/master/benchmarks/complex_benchmarks.png" class="img-fluid figure-img"></p>
<figcaption>Complex Fixed Effects Benchmark</figcaption>
</figure>
</div>
</section>
<section id="hac-standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="hac-standard-errors">HAC Standard Errors</h3>
<p>We now support HAC standard errors! Thanks for Daman (https://github.com/damandhaliwal) for all his work (and coping with me with the PR, which took forever to get through). We now support:</p>
<ul>
<li>time series HAC</li>
<li>panel HAC</li>
<li>panel DK</li>
</ul>
<p>variance-covariance matrices.</p>
<p>For now, we assume that the time series column is consecutive and each entry has “time delta 1”. Relaxation of this requirement are work in progress.</p>
</section>
<section id="cat_template-argument-for-plotting-functions" class="level3">
<h3 class="anchored" data-anchor-id="cat_template-argument-for-plotting-functions"><code>cat_template</code> argument for plotting functions</h3>
<p>For easier encoding of categorical variables in relation to the <code>iplot()</code> and <code>coefplot()</code> functions, we add a new function argument, cat_template:</p>
<div id="bd078a7f" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fit_c <span class="op">=</span> pf.feols(fml <span class="op">=</span> <span class="st">"Y ~ i(X1, f1)"</span>, data <span class="op">=</span> df)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fit_c.iplot(cat_template <span class="op">=</span> <span class="st">"</span><span class="sc">{variable}</span><span class="st">::</span><span class="sc">{value}</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
   <div id="SkGZBl"></div>
   <script type="text/javascript" data-lets-plot-script="plot">
   
   (function() {
   // ----------
   
   const forceImmediateRender = false;
   const responsive = false;
   
   let sizing = {
       width_mode: "MIN",
       height_mode: "SCALED",
       width: null, 
       height: null 
   };
   
   const preferredWidth = document.body.dataset.letsPlotPreferredWidth;
   if (preferredWidth !== undefined) {
       sizing = {
           width_mode: 'FIXED',
           height_mode: 'SCALED',
           width: parseFloat(preferredWidth)
       };
   }
   
   const containerDiv = document.getElementById("SkGZBl");
   let fig = null;
   
   function renderPlot() {
       if (fig === null) {
           const plotSpec = {
"data":{
"Coefficient":["X1::0.0","X1::1.0","X1::2.0"],
"Estimate":[0.060803847582425144,0.01554505263391628,-0.04732566601867734],
"2.5%":[0.040656842781977356,-0.003973305785076511,-0.06607275597434353],
"97.5%":[0.08095085238287293,0.03506341105290907,-0.028578576063011146],
"Model":["Y~i(X1,f1)","Y~i(X1,f1)","Y~i(X1,f1)"]
},
"mapping":{
"x":"Coefficient",
"y":"Estimate",
"color":"Model"
},
"data_meta":{
"series_annotations":[{
"type":"int",
"column":"level_0"
},{
"type":"int",
"column":"index"
},{
"type":"str",
"column":"Coefficient"
},{
"type":"float",
"column":"Estimate"
},{
"type":"float",
"column":"Std. Error"
},{
"type":"float",
"column":"t value"
},{
"type":"float",
"column":"Pr(>|t|)"
},{
"type":"float",
"column":"2.5%"
},{
"type":"float",
"column":"97.5%"
},{
"type":"str",
"column":"Model"
}]
},
"guides":{
"y":{
"title":"Estimate and 95.0% Confidence Interval"
}
},
"coord":{
"name":"flip",
"flip":true
},
"ggsize":{
"width":500.0,
"height":300.0
},
"theme":{
"axis_text_x":{
"angle":0.0,
"blank":false
}
},
"kind":"plot",
"scales":[],
"layers":[{
"geom":"point",
"mapping":{
},
"position":{
"name":"dodge",
"width":0.5
},
"data_meta":{
},
"data":{
}
},{
"geom":"errorbar",
"mapping":{
"ymin":"2.5%",
"ymax":"97.5%"
},
"position":{
"name":"dodge",
"width":0.5
},
"data_meta":{
},
"width":0.05,
"data":{
}
}],
"metainfo_list":[],
"spec_id":"1"
};
           window.letsPlotCall(function() { fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, containerDiv, sizing); });
       } else {
           fig.updateView({});
       }
   }
   
   const renderImmediately = 
       forceImmediateRender || (
           sizing.width_mode === 'FIXED' && 
           (sizing.height_mode === 'FIXED' || sizing.height_mode === 'SCALED')
       );
   
   if (renderImmediately) {
       renderPlot();
   }
   
   if (!renderImmediately || responsive) {
       // Set up observer for initial sizing or continuous monitoring
       var observer = new ResizeObserver(function(entries) {
           for (let entry of entries) {
               if (entry.contentBoxSize && 
                   entry.contentBoxSize[0].inlineSize > 0) {
                   if (!responsive && observer) {
                       observer.disconnect();
                       observer = null;
                   }
                   renderPlot();
                   if (!responsive) {
                       break;
                   }
               }
           }
       });
       
       observer.observe(containerDiv);
   }
   
   // ----------
   })();
   
   </script>
</div>
</div>
<p>This is particularly useful for Difference-in-Differences and event studies. You can find an example use case in the DiD <a href="https://py-econometrics.github.io/pyfixest/difference-in-differences.html#one-shot-adoption-static-and-dynamic-specifications">vignette</a>.</p>
<p>Going forward, we will deprecate the <code>rename_event_study_coefs</code> function, which is no longer needed (and did not work anyways).</p>
</section>
<section id="updates-to-gelbach-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="updates-to-gelbach-decomposition">Updates to Gelbach Decomposition</h3>
<p>We have reworked the Gelbach Decomposition method, with some breaking changes: by default, calling <code>Feols.decompose()</code> now returns a <code>GelbachDecomposition</code> instance - before, we’d return a <code>pd.DataFrame</code>. The <code>param</code> argument has been renamed to <code>decomp_var</code>, but is not yet deprecated.</p>
<p>The class now comes with new <code>tidy()</code> and <code>etable()</code> methods.</p>
<div id="099ba630" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.utils.dgps <span class="im">import</span> gelbach_data</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate test data using gelbach_data</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> gelbach_data(nobs<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"w"</span>] <span class="op">=</span> np.random.rand(<span class="dv">500</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> pf.feols(<span class="st">"y ~ x1 + x21 + x22 + x23"</span>, data<span class="op">=</span>data)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>gb <span class="op">=</span> fit.decompose(decomp_var <span class="op">=</span> <span class="st">"x1"</span>, x1_vars <span class="op">=</span> [<span class="st">"x21"</span>],reps <span class="op">=</span> <span class="dv">10</span>, nthreads <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(gb))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]100%|██████████| 10/10 [00:00&lt;00:00, 375.87it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pyfixest.estimation.decomposition.GelbachDecomposition'&gt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<p>It is now also possible to add background variables that are included in both the long and short regressions via the <code>x1_vars</code> function argument.</p>
<p>We can inspect results as a <code>pd.DataFrame</code></p>
<div id="bd9cf882" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gb.tidy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">coefficients</th>
<th data-quarto-table-cell-role="th">ci_lower</th>
<th data-quarto-table-cell-role="th">ci_upper</th>
<th data-quarto-table-cell-role="th">panels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">direct_effect</th>
<td>1.412165</td>
<td>0.790629</td>
<td>1.915116</td>
<td>Levels (units)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">full_effect</th>
<td>1.041753</td>
<td>1.006349</td>
<td>1.103581</td>
<td>Levels (units)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">explained_effect</th>
<td>0.370412</td>
<td>-0.247070</td>
<td>0.812981</td>
<td>Levels (units)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">unexplained_effect</th>
<td>1.041753</td>
<td>1.006349</td>
<td>1.103581</td>
<td>Levels (units)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">x22</th>
<td>0.061930</td>
<td>-0.329830</td>
<td>0.323314</td>
<td>Levels (units)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">x23</th>
<td>0.308483</td>
<td>0.080754</td>
<td>0.489668</td>
<td>Levels (units)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">direct_effect</th>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>Share of Full Effect</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">full_effect</th>
<td>0.737699</td>
<td>0.576561</td>
<td>1.313058</td>
<td>Share of Full Effect</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">explained_effect</th>
<td>0.262301</td>
<td>-0.313058</td>
<td>0.423439</td>
<td>Share of Full Effect</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">unexplained_effect</th>
<td>0.737699</td>
<td>0.576561</td>
<td>1.313058</td>
<td>Share of Full Effect</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">x22</th>
<td>0.043855</td>
<td>-0.417537</td>
<td>0.168116</td>
<td>Share of Full Effect</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">x23</th>
<td>0.218446</td>
<td>0.099813</td>
<td>0.255324</td>
<td>Share of Full Effect</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">direct_effect</th>
<td>3.812414</td>
<td>-8.254760</td>
<td>15.819275</td>
<td>Share of Explained Effect</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">full_effect</th>
<td>2.812414</td>
<td>-9.254760</td>
<td>14.819275</td>
<td>Share of Explained Effect</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">explained_effect</th>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>Share of Explained Effect</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">unexplained_effect</th>
<td>2.812414</td>
<td>-9.254760</td>
<td>14.819275</td>
<td>Share of Explained Effect</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">x22</th>
<td>0.167192</td>
<td>-1.435081</td>
<td>1.973541</td>
<td>Share of Explained Effect</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">x23</th>
<td>0.832808</td>
<td>-0.973541</td>
<td>2.435081</td>
<td>Share of Explained Effect</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>or produce a <code>GT</code> table:</p>
<div id="d2d50b35" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gb.etable(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> <span class="st">"all"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    caption <span class="op">=</span> <span class="st">"Gelbach Decomposition"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div id="lqmbuduyvo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#lqmbuduyvo table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#lqmbuduyvo thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#lqmbuduyvo p { margin: 0; padding: 0; }
 #lqmbuduyvo .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: hidden; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #lqmbuduyvo .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #lqmbuduyvo .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #lqmbuduyvo .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #lqmbuduyvo .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #lqmbuduyvo .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #lqmbuduyvo .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #lqmbuduyvo .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: bottom; padding-top: 4px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #lqmbuduyvo .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #lqmbuduyvo .gt_column_spanner_outer:first-child { padding-left: 0; }
 #lqmbuduyvo .gt_column_spanner_outer:last-child { padding-right: 0; }
 #lqmbuduyvo .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: bottom; padding-top: 4px; padding-bottom: 4px; overflow-x: hidden; display: inline-block; width: 100%; }
 #lqmbuduyvo .gt_spanner_row { border-bottom-style: hidden; }
 #lqmbuduyvo .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: none; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: white; border-right-style: none; border-right-width: 1px; border-right-color: white; vertical-align: middle; text-align: left; }
 #lqmbuduyvo .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: none; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: middle; }
 #lqmbuduyvo .gt_from_md> :first-child { margin-top: 0; }
 #lqmbuduyvo .gt_from_md> :last-child { margin-bottom: 0; }
 #lqmbuduyvo .gt_row { padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: middle; overflow-x: hidden; }
 #lqmbuduyvo .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #lqmbuduyvo .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #lqmbuduyvo .gt_row_group_first td { border-top-width: 0.5px; }
 #lqmbuduyvo .gt_row_group_first th { border-top-width: 0.5px; }
 #lqmbuduyvo .gt_striped { color: #333333; background-color: #F4F4F4; }
 #lqmbuduyvo .gt_table_body { border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }
 #lqmbuduyvo .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }
 #lqmbuduyvo .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }
 #lqmbuduyvo .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }
 #lqmbuduyvo .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #lqmbuduyvo .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #lqmbuduyvo .gt_left { text-align: left; }
 #lqmbuduyvo .gt_center { text-align: center; }
 #lqmbuduyvo .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #lqmbuduyvo .gt_font_normal { font-weight: normal; }
 #lqmbuduyvo .gt_font_bold { font-weight: bold; }
 #lqmbuduyvo .gt_font_italic { font-style: italic; }
 #lqmbuduyvo .gt_super { font-size: 65%; }
 #lqmbuduyvo .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #lqmbuduyvo .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="4" class="gt_heading gt_title gt_font_normal">Gelbach Decomposition</td>
</tr>
<tr class="gt_col_headings even">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Initial-Difference" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Initial Difference</th>
<th id="Adjusted-Difference" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Adjusted Difference</th>
<th id="Explained-Difference" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Explained Difference</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" class="gt_group_heading" data-quarto-table-cell-role="th">Levels (units)</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x1</th>
<td class="gt_row gt_center">1.412</td>
<td class="gt_row gt_center">1.042</td>
<td class="gt_row gt_center">0.370</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">[0.791, 1.915]</td>
<td class="gt_row gt_center">[1.006, 1.104]</td>
<td class="gt_row gt_center">[-0.247, 0.813]</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x22</th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">0.062</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">[-0.330, 0.323]</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x23</th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">0.308</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">[0.081, 0.490]</td>
</tr>
<tr class="gt_group_heading_row even">
<th colspan="4" class="gt_group_heading" data-quarto-table-cell-role="th">Share of Full Effect</th>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x1</th>
<td class="gt_row gt_center">1.000</td>
<td class="gt_row gt_center">0.738</td>
<td class="gt_row gt_center">0.262</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">[0.577, 1.313]</td>
<td class="gt_row gt_center">[-0.313, 0.423]</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x22</th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">0.044</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">[-0.418, 0.168]</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x23</th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">0.218</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">[0.100, 0.255]</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="4" class="gt_group_heading" data-quarto-table-cell-role="th">Share of Explained Effect</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x1</th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">1.000</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x22</th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">0.167</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">[-1.435, 1.974]</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">x23</th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">0.833</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th"></th>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">-</td>
<td class="gt_row gt_center">[-0.974, 2.435]</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="4" class="gt_sourcenote">Decomposition variable: x1. Control Variables: x21. CIs are computed using B = 10 bootstrap replications using iid sampling.Col 1: Adjusted Difference (by x21) - Coefficient on x1 in short regression. Col 2: Adjusted Difference - Coefficient on x1 in long regression. Col 3: Explained Difference - Difference in coefficients of x1 in short and long regression. Panel 1: Levels (units). Panel 2: Share of Full Effect: Levels normalized by coefficient of the short regression. Panel 3: Share of Explained Effect: Levels normalized by coefficient of the long regression.</td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
<p>As can be seen, we by default now return normalized (and not just absolute) effects.</p>
<p>We are now also supporting frequency weights for the decomposition (currently without inference).</p>
<p>Additionally, some house keeping and interal refactoring of the <code>GelbachDecomposition</code> class.</p>
</section>
</section>
<section id="pyfixest-0.30.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.30.0">PyFixest 0.30.0</h2>
<section id="new-features-1" class="level3">
<h3 class="anchored" data-anchor-id="new-features-1">New Features</h3>
<ul>
<li>We have created a <strong>Rust</strong> backend for all performance critical algorithms, with pretty great performance improvements! You can use the Rust backend by setting <code>demeaner_options = "rust"</code>.</li>
</ul>
<p>We find pretty great performance improvements and want to make the Rust backend the default in PyFixest 0.31.0.</p>
<p>To back up the performance claim, here is a benchmark:</p>
<div id="e0e64e35" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(<span class="dv">737</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10_000_000</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>benchmark_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Y"</span>: rng.normal(<span class="dv">0</span>, <span class="dv">1</span>, N),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"X1"</span>: rng.normal(<span class="dv">0</span>, <span class="dv">1</span>, N),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"X2"</span>: rng.normal(<span class="dv">0</span>, <span class="dv">1</span>, N),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"X3"</span>: rng.normal(<span class="dv">0</span>, <span class="dv">1</span>, N),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"f1"</span>: rng.integers(<span class="dv">0</span>, <span class="dv">10_000</span>, N),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"f2"</span>: rng.integers(<span class="dv">0</span>, <span class="dv">1_000</span>, N),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"f3"</span>: rng.integers(<span class="dv">0</span>, <span class="dv">10</span>, N),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># burn-in for numba</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>fit_nb_warmup <span class="op">=</span> pf.feols(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  fml <span class="op">=</span> <span class="st">"Y ~ X1 + X2 + X3 | f1 + f2 + f3"</span>, data <span class="op">=</span> benchmark_data[:<span class="dv">100_000</span>]</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># benchmark for numba backend</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>tic <span class="op">=</span> time.time()</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>fit_nb <span class="op">=</span> pf.feols(</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  fml <span class="op">=</span> <span class="st">"Y ~ X1 + X2 + X3 | f1 + f2 + f3"</span>, data <span class="op">=</span> benchmark_data</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>toc <span class="op">=</span> time.time()</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Numba backend took </span><span class="sc">{</span>toc<span class="op">-</span>tic<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co"># benchmark for rust backend</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>tic <span class="op">=</span> time.time()</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>fit_rust <span class="op">=</span> pf.feols(</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  fml <span class="op">=</span> <span class="st">"Y ~ X1 + X2 + X3 | f1 + f2 + f3"</span>, data <span class="op">=</span> benchmark_data,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  demeaner_backend <span class="op">=</span> <span class="st">"rust"</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>toc <span class="op">=</span> time.time()</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Rust backend took </span><span class="sc">{</span>toc<span class="op">-</span>tic<span class="sc">}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/model_matrix_fixest_.py:215: UserWarning: 1 singleton fixed effect(s) detected. These observations are dropped from the model.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Numba backend took 4.84276270866394.
Rust backend took 6.08347487449646.</code></pre>
</div>
</div>
<p>Results are also matching =)</p>
<div id="25c37b51" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pf.etable([fit_nb, fit_rust], digits <span class="op">=</span> <span class="dv">8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div id="ylypfrgmyf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#ylypfrgmyf table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#ylypfrgmyf thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#ylypfrgmyf p { margin: 0; padding: 0; }
 #ylypfrgmyf .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #ylypfrgmyf .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #ylypfrgmyf .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #ylypfrgmyf .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #ylypfrgmyf .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #ylypfrgmyf .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #ylypfrgmyf .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #ylypfrgmyf .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: bottom; padding-top: 4px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #ylypfrgmyf .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #ylypfrgmyf .gt_column_spanner_outer:first-child { padding-left: 0; }
 #ylypfrgmyf .gt_column_spanner_outer:last-child { padding-right: 0; }
 #ylypfrgmyf .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: bottom; padding-top: 4px; padding-bottom: 4px; overflow-x: hidden; display: inline-block; width: 100%; }
 #ylypfrgmyf .gt_spanner_row { border-bottom-style: hidden; }
 #ylypfrgmyf .gt_group_heading { padding-top: 0px; padding-bottom: 0px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: white; border-right-style: none; border-right-width: 1px; border-right-color: white; vertical-align: middle; text-align: left; }
 #ylypfrgmyf .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: middle; }
 #ylypfrgmyf .gt_from_md> :first-child { margin-top: 0; }
 #ylypfrgmyf .gt_from_md> :last-child { margin-bottom: 0; }
 #ylypfrgmyf .gt_row { padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: middle; overflow-x: hidden; }
 #ylypfrgmyf .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #ylypfrgmyf .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #ylypfrgmyf .gt_row_group_first td { border-top-width: 0.5px; }
 #ylypfrgmyf .gt_row_group_first th { border-top-width: 0.5px; }
 #ylypfrgmyf .gt_striped { color: #333333; background-color: #F4F4F4; }
 #ylypfrgmyf .gt_table_body { border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }
 #ylypfrgmyf .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }
 #ylypfrgmyf .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }
 #ylypfrgmyf .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }
 #ylypfrgmyf .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #ylypfrgmyf .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #ylypfrgmyf .gt_left { text-align: left; }
 #ylypfrgmyf .gt_center { text-align: center; }
 #ylypfrgmyf .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #ylypfrgmyf .gt_font_normal { font-weight: normal; }
 #ylypfrgmyf .gt_font_bold { font-weight: bold; }
 #ylypfrgmyf .gt_font_italic { font-style: italic; }
 #ylypfrgmyf .gt_super { font-size: 65%; }
 #ylypfrgmyf .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #ylypfrgmyf .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="2" id="Y" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Y</span></th>
</tr>
<tr class="gt_col_headings even">
<th id="0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(1)</th>
<th id="1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(2)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="3" class="gt_group_heading" data-quarto-table-cell-role="th">coef</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">X1</th>
<td class="gt_row gt_center">0.00022257<br>
(0.00031662)</td>
<td class="gt_row gt_center">0.00022257<br>
(0.00031662)</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">X2</th>
<td class="gt_row gt_center">0.00020980<br>
(0.00031647)</td>
<td class="gt_row gt_center">0.00020980<br>
(0.00031647)</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">X3</th>
<td class="gt_row gt_center">0.00062145*<br>
(0.00031651)</td>
<td class="gt_row gt_center">0.00062145*<br>
(0.00031651)</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="3" class="gt_group_heading" data-quarto-table-cell-role="th">fe</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">f1</th>
<td class="gt_row gt_center">x</td>
<td class="gt_row gt_center">x</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">f3</th>
<td class="gt_row gt_center">x</td>
<td class="gt_row gt_center">x</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">f2</th>
<td class="gt_row gt_center">x</td>
<td class="gt_row gt_center">x</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="3" class="gt_group_heading" data-quarto-table-cell-role="th">stats</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">Observations</th>
<td class="gt_row gt_center">10000000</td>
<td class="gt_row gt_center">10000000</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">S.E. type</th>
<td class="gt_row gt_center">iid</td>
<td class="gt_row gt_center">iid</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">R<sup>2</sup></th>
<td class="gt_row gt_center">0.00111366</td>
<td class="gt_row gt_center">0.00111366</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">R<sup>2</sup> Within</th>
<td class="gt_row gt_center">4.8e-07000</td>
<td class="gt_row gt_center">4.8e-07000</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="3" class="gt_sourcenote">Significance levels: * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001. Format of coefficient cell: Coefficient (Std. Error)</td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
<ul>
<li>We now support <strong>quantile regression</strong>, including a Frisch-Newton Interior Point Solver with and without preprocessing, iid, heteroskedastic and cluster robust standard errors, fast algorithms for the entire quantile regression process, and some visualisations. In particular the algorithms for the quantile regression process show excellent performance. You can learn more about all features and take a look at more systematic benchmarks in the <a href="https://py-econometrics.github.io/pyfixest/quantile-regression.html">quantreg vignette</a>.</li>
</ul>
<div id="8f544df2" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>N_qr <span class="op">=</span> <span class="dv">10_000</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(<span class="dv">929</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df_qr <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"X1"</span>: rng.normal(<span class="dv">0</span>, <span class="dv">1</span>, N_qr),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"X2"</span>: rng.normal(<span class="dv">0</span>, <span class="dv">1</span>, N_qr)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df_qr[<span class="st">"Y"</span>] <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> df_qr[<span class="st">"X1"</span>] <span class="op">+</span> <span class="fl">1.9</span> <span class="op">*</span> df_qr[<span class="st">"X1"</span>] <span class="op">**</span> <span class="dv">4</span> <span class="op">+</span> df_qr[<span class="st">"X2"</span>] <span class="op">-</span> <span class="fl">0.4</span> <span class="op">*</span> df_qr[<span class="st">"X2"</span>] <span class="op">**</span><span class="dv">7</span> <span class="op">+</span> rng.normal(<span class="dv">0</span>, <span class="dv">1</span>, N_qr)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>fit_qr <span class="op">=</span> pf.quantreg(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  fml <span class="op">=</span> <span class="st">"Y ~ X1 + X2"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> df_qr,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  quantile <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>],</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  method <span class="op">=</span> <span class="st">"pfn"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  multi_method <span class="op">=</span> <span class="st">"cfm2"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>pf.qplot(fit_qr, figsize <span class="op">=</span> [<span class="dv">7</span>,<span class="dv">3</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:77: FutureWarning: 
           The Quantile Regression implementation is experimental and may change in future releases.
           But mostly, we expect the API to remain unchanged.
           
  warnings.warn(
/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:237: UserWarning: The Frisch-Newton Interior Point solver has not converged after 6160 iterations.
  warnings.warn(
/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:237: UserWarning: The Frisch-Newton Interior Point solver has not converged after 6640 iterations.
  warnings.warn(
/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:237: UserWarning: The Frisch-Newton Interior Point solver has not converged after 5839 iterations.
  warnings.warn(
/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:237: UserWarning: The Frisch-Newton Interior Point solver has not converged after 6354 iterations.
  warnings.warn(
/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/quantreg/quantreg_.py:237: UserWarning: The Frisch-Newton Interior Point solver has not converged after 6424 iterations.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(&lt;Figure size 672x288 with 3 Axes&gt;,
 array([&lt;Axes: title={'center': 'Intercept'}, xlabel='Quantile', ylabel='Coefficient (95 % CI)'&gt;,
        &lt;Axes: title={'center': 'X1'}, xlabel='Quantile', ylabel='Coefficient (95 % CI)'&gt;,
        &lt;Axes: title={'center': 'X2'}, xlabel='Quantile', ylabel='Coefficient (95 % CI)'&gt;],
       dtype=object))</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="changelog_files/figure-html/cell-9-output-3.png" width="661" height="276" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>We have switched the <strong>default solver</strong> to <code>scipy.linalg.solve()</code>: <a href="https://github.com/py-econometrics/pyfixest/pull/904">link</a></p></li>
<li><p>You can now set the <strong>maximum number of iterations</strong> for the demeaning algo via a <code>fixef_maxiter</code> argument: <a href="https://github.com/py-econometrics/pyfixest/pull/944">link</a></p></li>
</ul>
</section>
<section id="bug-fixes" class="level3">
<h3 class="anchored" data-anchor-id="bug-fixes">Bug Fixes</h3>
<ul>
<li>We fixed a bug in internal renaming of categoricals: <a href="https://github.com/py-econometrics/pyfixest/pull/886">link</a></li>
<li>We fixed a bug in etable arguments <a href="https://github.com/py-econometrics/pyfixest/pull/889">link</a></li>
<li>We stopped casting dependent variable to integer to void Information Loss in Poisson Regression: <a href="https://github.com/py-econometrics/pyfixest/pull/900">link</a></li>
</ul>
</section>
<section id="documentation" class="level3">
<h3 class="anchored" data-anchor-id="documentation">Documentation</h3>
<ul>
<li>We have added a guide on how to replicate Stata results with pyfixest: <a href="https://github.com/py-econometrics/pyfixest/pull/897">link</a></li>
<li>We improved the documentation on how to relabel variable names in the plotting and etable functions: <a href="https://github.com/py-econometrics/pyfixest/pull/895">link</a></li>
</ul>
</section>
</section>
<section id="infrastructure" class="level2">
<h2 class="anchored" data-anchor-id="infrastructure">Infrastructure</h2>
<ul>
<li>We have reorganized our tests and rely more on conda environments for making R package test dependencies available: <a href="https://github.com/py-econometrics/pyfixest/pull/906">link</a></li>
</ul>
<section id="community" class="level3">
<h3 class="anchored" data-anchor-id="community">Community</h3>
<ul>
<li>We have added a Code of Conduct.</li>
<li>We have opened our discord community. Please join us there to discuss pyfixest and other py-econometrics projects! Link <a href="https://discord.com/invite/gBAydeDMVK">here</a>.</li>
</ul>
</section>
</section>
<section id="new-contributors" class="level2">
<h2 class="anchored" data-anchor-id="new-contributors">New Contributors</h2>
<ul>
<li><span class="citation" data-cites="FuZhiyu">@FuZhiyu</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/886</li>
<li><span class="citation" data-cites="mortizm1988">@mortizm1988</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/895</li>
<li><span class="citation" data-cites="jestover">@jestover</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/897</li>
<li><span class="citation" data-cites="JaapCTJ">@JaapCTJ</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/900</li>
<li><span class="citation" data-cites="shapiromh">@shapiromh</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/906</li>
<li><span class="citation" data-cites="schroedk">@schroedk</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/905</li>
<li><span class="citation" data-cites="WiktorTheScriptor">@WiktorTheScriptor</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/938</li>
<li><span class="citation" data-cites="damandhaliwal">@damandhaliwal</span> made their first contribution in https://github.com/py-econometrics/pyfixest/pull/944</li>
</ul>
<p><strong>Full Changelog</strong>: https://github.com/py-econometrics/pyfixest/compare/v0.29.0…v0.30.0</p>
</section>
<section id="pyfixest-0.29.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.29.0">PyFixest 0.29.0</h2>
<ul>
<li><p>We add options <code>fixef_k = "nested"</code> and <code>fixef_k = "full"</code> for computing small sample corrections via <code>pf.ssc()</code>. We set the defaults for <code>pf.feols()</code> and other estimation functions to <code>fixef_k = "nested"</code> to 100% mimic the defaults of <code>r-fixest</code>. This is a “breaking change” in the sense that it might (slightly) impact the standard errors of your estimations.</p></li>
<li><p>We add support for fully saturated event study estimation via the <code>SaturatedEventStudy</code> class, which can be called via <code>pf.event_study()</code>.</p></li>
<li><p>We add support for difference-in-differences specification tests following Lal (2025).</p></li>
<li><p>We add R2-within values to the default <code>etable()</code> output.</p></li>
<li><p>We fix a small bug in the Gelbach <code>decompose()</code> method, which would fail if a user selected <code>only_coef = True</code>.</p></li>
<li><p>The <code>decompose()</code> method runs fully on sparse matrices, which leads to large performance improvements on big data sets.</p></li>
<li><p>We fix a small bug in the <code>predict()</code> method with <code>newdata</code>, see <a href="https://github.com/py-econometrics/pyfixest/issues/840">here</a> for details.</p></li>
<li><p>We add a function argument <code>rename_models</code> to help rename model names in the <code>coefplot()</code> and <code>iplot()</code> functions and methods:</p>
<div id="137ea9cc" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pf.coefplot(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> [fit1, fit2, fit3],</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    rename_models <span class="op">=</span> {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        fit1._model_name_plot: <span class="st">"Model 1"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        fit2._model_name_plot: <span class="st">"Model 2"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        fit3._model_name_plot: <span class="st">"Model 3"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
   <div id="C6MI8q"></div>
   <script type="text/javascript" data-lets-plot-script="plot">

   (function() {
   // ----------

   const forceImmediateRender = false;
   const responsive = false;

   let sizing = {
       width_mode: "MIN",
       height_mode: "SCALED",
       width: null, 
       height: null 
   };

   const preferredWidth = document.body.dataset.letsPlotPreferredWidth;
   if (preferredWidth !== undefined) {
       sizing = {
           width_mode: 'FIXED',
           height_mode: 'SCALED',
           width: parseFloat(preferredWidth)
       };
   }

   const containerDiv = document.getElementById("C6MI8q");
   let fig = null;

   function renderPlot() {
       if (fig === null) {
           const plotSpec = {
"data":{
"Coefficient":["Intercept","Intercept","X1","X1","X1","Intercept","Intercept","X1","X1","X1","X2","X2","X1","X1","X1","X2","X2"],
"Estimate":[0.9185177588356426,0.8887791489339358,-1.000085840074156,-0.9929357698186859,-0.949525571419159,0.9185177588356426,0.8887791489339358,-1.000085840074156,-0.9929357698186859,-0.949525571419159,-0.17634236659778285,-0.17422527489454384,-1.000085840074156,-0.9929357698186859,-0.949525571419159,-0.17634236659778285,-0.17422527489454384],
"2.5%":[0.6990856170653885,0.6760162836776398,-1.1663660739416457,-1.1540790755856785,-1.0797772495833682,0.6990856170653885,0.6760162836776398,-1.1663660739416457,-1.1540790755856785,-1.0797772495833682,-0.2190548570563819,-0.2087554961215888,-1.1663660739416457,-1.1540790755856785,-1.0797772495833682,-0.2190548570563819,-0.2087554961215888],
"97.5%":[1.1379499006058966,1.101542014190232,-0.8338056062066661,-0.8317924640516935,-0.8192738932549499,1.1379499006058966,1.101542014190232,-0.8338056062066661,-0.8317924640516935,-0.8192738932549499,-0.1336298761391838,-0.13969505366749888,-0.8338056062066661,-0.8317924640516935,-0.8192738932549499,-0.1336298761391838,-0.13969505366749888],
"Model":["Model 1","Model 2","Model 1","Model 2","Model 3","Model 1","Model 2","Model 1","Model 2","Model 3","Model 2","Model 3","Model 1","Model 2","Model 3","Model 2","Model 3"]
},
"mapping":{
"x":"Coefficient",
"y":"Estimate",
"color":"Model"
},
"data_meta":{
"series_annotations":[{
"type":"int",
"column":"level_0"
},{
"type":"str",
"column":"Coefficient"
},{
"type":"int",
"column":"index"
},{
"type":"float",
"column":"Estimate"
},{
"type":"float",
"column":"Std. Error"
},{
"type":"float",
"column":"t value"
},{
"type":"float",
"column":"Pr(>|t|)"
},{
"type":"float",
"column":"2.5%"
},{
"type":"float",
"column":"97.5%"
},{
"type":"str",
"column":"Model"
}]
},
"guides":{
"y":{
"title":"Estimate and 95.0% Confidence Interval"
}
},
"coord":{
"name":"flip",
"flip":true
},
"ggsize":{
"width":500.0,
"height":300.0
},
"theme":{
"axis_text_x":{
"angle":0.0,
"blank":false
}
},
"kind":"plot",
"scales":[],
"layers":[{
"geom":"point",
"mapping":{
},
"position":{
"name":"dodge",
"width":0.5
},
"data_meta":{
},
"data":{
}
},{
"geom":"errorbar",
"mapping":{
"ymin":"2.5%",
"ymax":"97.5%"
},
"position":{
"name":"dodge",
"width":0.5
},
"data_meta":{
},
"width":0.05,
"data":{
}
},{
"geom":"hline",
"mapping":{
},
"data_meta":{
},
"yintercept":0.0,
"linetype":"dashed",
"color":"black",
"data":{
}
}],
"metainfo_list":[],
"spec_id":"2"
};
           window.letsPlotCall(function() { fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, containerDiv, sizing); });
       } else {
           fig.updateView({});
       }
   }

   const renderImmediately = 
       forceImmediateRender || (
           sizing.width_mode === 'FIXED' && 
           (sizing.height_mode === 'FIXED' || sizing.height_mode === 'SCALED')
       );

   if (renderImmediately) {
       renderPlot();
   }

   if (!renderImmediately || responsive) {
       // Set up observer for initial sizing or continuous monitoring
       var observer = new ResizeObserver(function(entries) {
           for (let entry of entries) {
               if (entry.contentBoxSize && 
                   entry.contentBoxSize[0].inlineSize > 0) {
                   if (!responsive && observer) {
                       observer.disconnect();
                       observer = null;
                   }
                   renderPlot();
                   if (!responsive) {
                       break;
                   }
               }
           }
       });

       observer.observe(containerDiv);
   }

   // ----------
   })();

   </script>
</div>
</div></li>
<li><p>Made <code>lets-plot</code> an optional dependency. The package will now fall back to <code>matplotlib</code> for plotting if <code>lets-plot</code> is not installed. Users can install <code>lets-plot</code> with <code>pip install pyfixest[plots]</code>.</p></li>
<li><p>PyFixest now supports R2, adjusted R2, and within-R2 values for WLS (it previously only did for OLS, if at all).</p></li>
<li><p>We add support for standard error of predictions for OLS models without fixed effects. As a default, the predict model still returns a <code>np.ndarray</code>. If the argument <code>se_fit</code> is set to <code>True</code>, we report the prediction standard errors. If argument <code>interval = "prediction"</code>, we return a <code>pd.DataFrame</code> with predictions, their standard errors, and confidence intervals.</p></li>
</ul>
</section>
<section id="pyfixest-0.28.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.28.0">PyFixest 0.28.0</h2>
<section id="new-features-and-bug-fixes" class="level3">
<h3 class="anchored" data-anchor-id="new-features-and-bug-fixes">New features and bug fixes</h3>
<ul>
<li>Adds a function argument <code>context</code>, that allows to pass information / context to the <code>formulaic.Formulaic.get_model_matrix()</code> call that creates the model matrix.</li>
<li>Fix a bug that caused reindexing of <code>LPDID._coeftable</code> when calling <code>LPDID.iplot()</code>. As a result, a second call of <code>LPDID.iplot()</code> would fail.</li>
<li>Bumps the required <code>formulaic</code> version to <code>1.1.0</code> and fixes errors that arose when a) the ref argument was used for i() syntax, which led to a silent failure under formulaic &gt;= 1.1.0, and fixef() / predict() with fixed effects, which led to a loud error.</li>
</ul>
</section>
<section id="new-experimental-features" class="level3">
<h3 class="anchored" data-anchor-id="new-experimental-features">New experimental Features</h3>
<ul>
<li>Adds a <code>pf.feglm()</code> function that supports GLMs with normal and binomial families (gaussian, logit, probit) without fixed effects. Fixed effects support is work in progress.</li>
<li>Adds options to run the demean function via JAX. This might speed up the model fit if GPU is available.</li>
</ul>
</section>
</section>
<section id="pyfixest-0.27.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.27.0">PyFixest 0.27.0</h2>
<ul>
<li>Adds support for Gelbach’s (JoLe 2016) Regression Decomposition method using a <code>decompose()</code> method for <code>Feols</code>.</li>
<li>Adds support for the multiple hypothesis correction by Westfall &amp; Young via the <code>pf.wyoung()</code> function.</li>
<li>Input data frames to <code>pf.feols()</code> and <code>pf.fepois()</code> are now converted to <code>pandas</code> via <a href="https://github.com/narwhals-dev/narwhals">narwhals</a>. As a result, users can not provide <code>duckdb</code> or <code>ibis</code> tables as inputs, as well as <code>pandas</code> and <code>polars</code> data frames. <code>polars</code> and <code>pyarrow</code> are dropped as a dependencies.</li>
<li>Fixes a bug in the <code>wildboottest</code> method, which incorrectly used to run a regression on the demeaned dependend variable in case it was applied after a fixed effects regression. My apologies for that!</li>
<li>Fixes a bug in the <code>ritest</code> method, which would use randomization inference coefficients instead of t-statistics, leading to incorrect results. This has consequences for the rwolf() function, which, in case of running ri-inference, would default to run the randomization-t. My apolgies!</li>
<li>Adds a vignette on multiple testing corrections.</li>
<li>Adds a vignette on Gelbach’s regression decomposition.</li>
</ul>
</section>
<section id="pyfixest-0.22.0---0.25.4" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.22.0---0.25.4">PyFixest 0.22.0 - 0.25.4</h2>
<p>See the github changelog for details: <a href="https://github.com/py-econometrics/pyfixest/releases">link</a>.</p>
</section>
<section id="pyfixest-0.22.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.22.0">PyFixest 0.22.0</h2>
<section id="changes" class="level3">
<h3 class="anchored" data-anchor-id="changes">Changes</h3>
<ul>
<li>Fix bug in wildboottest method <span class="citation" data-cites="s3alfisc">@s3alfisc</span> (#506)</li>
<li>docs: add sanskriti2005 as a contributor for infra <span class="citation" data-cites="allcontributors">@allcontributors</span> (#503)</li>
<li>Infra: added the release-drafter for automation of release notes <span class="citation" data-cites="sanskriti2005">@sanskriti2005</span> (#502)</li>
<li>Fix broken link in contributing.md <span class="citation" data-cites="s3alfisc">@s3alfisc</span> (#499)</li>
<li>docs: add leostimpfle as a contributor for bug <span class="citation" data-cites="allcontributors">@allcontributors</span> (#495)</li>
<li>Update justfile <span class="citation" data-cites="leostimpfle">@leostimpfle</span> (#494)</li>
<li>docs: add baggiponte as a contributor for doc <span class="citation" data-cites="allcontributors">@allcontributors</span> (#490)</li>
<li>docs: improve installation section <span class="citation" data-cites="baggiponte">@baggiponte</span> (#489)</li>
<li>Bump tornado from 6.4 to 6.4.1 <span class="citation" data-cites="dependabot">@dependabot</span> (#487)</li>
<li>docs: add leostimpfle as a contributor for code <span class="citation" data-cites="allcontributors">@allcontributors</span> (#478)</li>
<li>Feols: speed up the creation of interacted fixed effects via <code>fe1^fe2</code> syntax <span class="citation" data-cites="leostimpfle">@leostimpfle</span> (#475)</li>
<li>rename resampling iterations to ‘reps’ in all methods <span class="citation" data-cites="s3alfisc">@s3alfisc</span> (#474)</li>
<li>fix a lot of broken links throught the repo <span class="citation" data-cites="s3alfisc">@s3alfisc</span> (#472)</li>
<li>Multiple readme fixes required after package was moved to py-econometrics project <span class="citation" data-cites="s3alfisc">@s3alfisc</span> (#450)</li>
</ul>
</section>
<section id="infrastructure-1" class="level3">
<h3 class="anchored" data-anchor-id="infrastructure-1">Infrastructure</h3>
<ul>
<li>infrastructure: fix minor release drafter bugs <span class="citation" data-cites="s3alfisc">@s3alfisc</span> (#504)</li>
</ul>
</section>
</section>
<section id="pyfixest-0.21.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.21.0">PyFixest 0.21.0</h2>
<ul>
<li>Add support for randomization inference via the <code>ritest()</code> method:</li>
</ul>
<div id="9a397488" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pf.get_data()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> pf.feols(<span class="st">"Y ~ X1"</span>, data <span class="op">=</span> data)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>fit.ritest(resampvar<span class="op">=</span><span class="st">"X1=0"</span>, reps <span class="op">=</span> <span class="dv">1000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pyfixest-0.20.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.20.0">PyFixest 0.20.0</h2>
<ul>
<li>This version introduces MyPy type checks to the entire pyfixest codebase. Thanks to <span class="citation" data-cites="juanitorduz">@juanitorduz</span> for nudging me to get started with this =). It also fixes a handful of smaller bugs.</li>
</ul>
</section>
<section id="pyfixest-0.19.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.19.0">PyFixest 0.19.0</h2>
<ul>
<li>Fixes multiple smaller and larger performance regressions. The NYC-Taxi example regression now takes approximately 22 seconds to run (… if my laptopt is connected to a power charger)!</li>
</ul>
<div id="fd0c471f" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># %%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>nyc <span class="op">=</span> duckdb.sql(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'''</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM 'C:/Users/alexa/Documents/nyc-taxi/**/*.parquet'</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">        tip_amount, trip_distance, passenger_count,</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="st">        vendor_id, payment_type, dropoff_at,</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">        dayofweek(dropoff_at) AS dofw</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE year = 2012 AND month &lt;= 3</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="st">    '''</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    ).df()</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># convert dowf, vendor_id, payment_type to categorical</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>tic <span class="op">=</span> time.time()</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>nyc[<span class="st">"dofw"</span>] <span class="op">=</span> nyc[<span class="st">"dofw"</span>].astype(<span class="bu">int</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>nyc[<span class="st">"vendor_id"</span>] <span class="op">=</span> nyc[<span class="st">"vendor_id"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>nyc[<span class="st">"payment_type"</span>] <span class="op">=</span> nyc[<span class="st">"payment_type"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"""</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="ss">    I am convering columns of type 'objects' to 'categories' and 'int'data types outside</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="ss">    of the regression, hence I am cheating a bit. This saves </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(time.time() <span class="op">-</span> tic)<span class="sc">}</span><span class="ss"> seconds.</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">#    I am convering columns of type 'objects' to 'categories' and 'int'data types outside</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">#    of the regression, hence I am cheating a bit. This saves 7.0 seconds.</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>run <span class="op">=</span> <span class="va">True</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> run:</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mock regression for JIT compilation</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> pf.feols(</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>        fml <span class="op">=</span> <span class="st">"tip_amount ~ trip_distance + passenger_count | vendor_id + payment_type + dofw"</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> nyc.iloc[<span class="dv">1</span>:<span class="dv">10_000</span>],</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>        copy_data <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>        store_data <span class="op">=</span> <span class="va">False</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> time</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    tic <span class="op">=</span> time.time()</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> pf.feols(</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>        fml <span class="op">=</span> <span class="st">"tip_amount ~ trip_distance + passenger_count | vendor_id + payment_type + dofw"</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> nyc,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>        copy_data <span class="op">=</span> <span class="va">False</span>, <span class="co"># saves a few seconds</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>        store_data <span class="op">=</span> <span class="va">False</span> <span class="co"># saves a few second</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    passed <span class="op">=</span> time.time() <span class="op">-</span> tic</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Passed time is </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(passed)<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Passed time is 22.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>Adds three new function arguments to <code>feols()</code> and <code>fepois()</code>: <code>copy_data</code>, <code>store_data</code>, and <code>fixef_tol</code>.</li>
<li>Adds support for frequency weights with the <code>weights_type</code> function argument.</li>
</ul>
<div id="02c063ae" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pf.get_data(N <span class="op">=</span> <span class="dv">10000</span>, model <span class="op">=</span> <span class="st">"Fepois"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df_weighted <span class="op">=</span> data[[<span class="st">"Y"</span>, <span class="st">"X1"</span>, <span class="st">"f1"</span>]].groupby([<span class="st">"Y"</span>, <span class="st">"X1"</span>, <span class="st">"f1"</span>]).size().reset_index().rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"count"</span>})</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>df_weighted[<span class="st">"id"</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(df_weighted.shape[<span class="dv">0</span>]))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dimension of the aggregated df:"</span>, df_weighted.shape)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_weighted.head())</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> pf.feols(</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y ~ X1 | f1"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>fit_weighted <span class="op">=</span> pf.feols(</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y ~ X1 | f1"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df_weighted,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> <span class="st">"count"</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    weights_type <span class="op">=</span> <span class="st">"fweights"</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>pf.etable([fit, fit_weighted], coef_fmt <span class="op">=</span> <span class="st">"b(se) </span><span class="ch">\n</span><span class="st"> (t) </span><span class="ch">\n</span><span class="st"> (p)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dimension of the aggregated df: (1278, 5)
     Y   X1   f1  count  id
0  0.0  0.0  0.0     17   0
1  0.0  0.0  1.0     11   1
2  0.0  0.0  2.0     10   2
3  0.0  0.0  3.0     17   3
4  0.0  0.0  4.0     14   4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/model_matrix_fixest_.py:215: UserWarning: 1 singleton fixed effect(s) detected. These observations are dropped from the model.
  warnings.warn(
/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/model_matrix_fixest_.py:215: UserWarning: 1 singleton fixed effect(s) detected. These observations are dropped from the model.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div id="vewpjqrkpj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#vewpjqrkpj table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#vewpjqrkpj thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#vewpjqrkpj p { margin: 0; padding: 0; }
 #vewpjqrkpj .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: hidden; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #vewpjqrkpj .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #vewpjqrkpj .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #vewpjqrkpj .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #vewpjqrkpj .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #vewpjqrkpj .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #vewpjqrkpj .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #vewpjqrkpj .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: bottom; padding-top: 4px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #vewpjqrkpj .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #vewpjqrkpj .gt_column_spanner_outer:first-child { padding-left: 0; }
 #vewpjqrkpj .gt_column_spanner_outer:last-child { padding-right: 0; }
 #vewpjqrkpj .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: bottom; padding-top: 4px; padding-bottom: 4px; overflow-x: hidden; display: inline-block; width: 100%; }
 #vewpjqrkpj .gt_spanner_row { border-bottom-style: hidden; }
 #vewpjqrkpj .gt_group_heading { padding-top: 0px; padding-bottom: 0px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; border-left-style: none; border-left-width: 1px; border-left-color: white; border-right-style: none; border-right-width: 1px; border-right-color: white; vertical-align: middle; text-align: left; }
 #vewpjqrkpj .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 0px; font-weight: initial; border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 0.5px; border-bottom-color: black; vertical-align: middle; }
 #vewpjqrkpj .gt_from_md> :first-child { margin-top: 0; }
 #vewpjqrkpj .gt_from_md> :last-child { margin-bottom: 0; }
 #vewpjqrkpj .gt_row { padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: none; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 0px; border-left-color: white; border-right-style: none; border-right-width: 0px; border-right-color: white; vertical-align: middle; overflow-x: hidden; }
 #vewpjqrkpj .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: hidden; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #vewpjqrkpj .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #vewpjqrkpj .gt_row_group_first td { border-top-width: 0.5px; }
 #vewpjqrkpj .gt_row_group_first th { border-top-width: 0.5px; }
 #vewpjqrkpj .gt_striped { color: #333333; background-color: #F4F4F4; }
 #vewpjqrkpj .gt_table_body { border-top-style: solid; border-top-width: 0.5px; border-top-color: black; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: black; }
 #vewpjqrkpj .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }
 #vewpjqrkpj .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }
 #vewpjqrkpj .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }
 #vewpjqrkpj .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #vewpjqrkpj .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #vewpjqrkpj .gt_left { text-align: left; }
 #vewpjqrkpj .gt_center { text-align: center; }
 #vewpjqrkpj .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #vewpjqrkpj .gt_font_normal { font-weight: normal; }
 #vewpjqrkpj .gt_font_bold { font-weight: bold; }
 #vewpjqrkpj .gt_font_italic { font-style: italic; }
 #vewpjqrkpj .gt_super { font-size: 65%; }
 #vewpjqrkpj .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #vewpjqrkpj .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="2" id="Y" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Y</span></th>
</tr>
<tr class="gt_col_headings even">
<th id="0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(1)</th>
<th id="1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">(2)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="3" class="gt_group_heading" data-quarto-table-cell-role="th">coef</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">X1</th>
<td class="gt_row gt_center">0.001(0.012)<br>
(0.088)<br>
(0.930)</td>
<td class="gt_row gt_center">0.001(0.012)<br>
(0.088)<br>
(0.930)</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="3" class="gt_group_heading" data-quarto-table-cell-role="th">fe</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">f1</th>
<td class="gt_row gt_center">x</td>
<td class="gt_row gt_center">x</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="3" class="gt_group_heading" data-quarto-table-cell-role="th">stats</th>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">Observations</th>
<td class="gt_row gt_center">9996</td>
<td class="gt_row gt_center">9996</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">S.E. type</th>
<td class="gt_row gt_center">iid</td>
<td class="gt_row gt_center">iid</td>
</tr>
<tr class="even">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">R<sup>2</sup></th>
<td class="gt_row gt_center">0.011</td>
<td class="gt_row gt_center">0.011</td>
</tr>
<tr class="odd">
<th class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th">R<sup>2</sup> Within</th>
<td class="gt_row gt_center">0.000</td>
<td class="gt_row gt_center">0.000</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="3" class="gt_sourcenote">Significance levels: * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001. Format of coefficient cell: Coefficient(Std. Error) (t-stats) (p-value)</td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
<ul>
<li>Bugfix: Wild Cluster Bootstrap Inference with Weights would compute unweighted standard errors. Sorry about that! WLS is not supported for the WCB.</li>
<li>Adds support for CRV3 inference with weights.</li>
</ul>
</section>
<section id="pyfixest-0.18.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.18.0">PyFixest 0.18.0</h2>
<ul>
<li>Large Refactoring of Interal Processing of Model Formulas, in particular <code>FixestFormulaParser</code> and <code>model_matrix_fixest</code>. As a results, the code should be cleaner and more robust.</li>
<li>Thanks to the refactoring, we can now bump the required <code>formulaic</code> version to the stable <code>1.0.0</code> release.</li>
<li>The <code>fml</code> argument of <code>model_matrix_fixest</code> is deprecated. Instead, <code>model_matrix_fixest</code> now asks for a <code>FixestFormula</code>, which is essentially a dictionary with information on model specifications like a first stage formula (if applicable), dependent variables, fixed effects, etc.</li>
<li>Additionally, <code>model_matrix_fixest</code> now returns a dictionary instead of a tuple.</li>
<li>Brings back fixed effects reference setting via <code>i(var1, var2, ref)</code> syntax. Deprecates the <code>i_ref1</code>, <code>i_ref2</code> function arguments. I.e. it is again possible to e.g.&nbsp;run</li>
</ul>
<div id="978234fc" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pf.get_data()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>fit1 <span class="op">=</span> pf.feols(<span class="st">"Y ~ i(f1, X2)"</span>, data<span class="op">=</span>data)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>fit1.coef()[<span class="dv">0</span>:<span class="dv">8</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Via the <code>ref</code> syntax, via can set the reference level:</p>
<div id="7889061a" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="op">=</span> pf.feols(<span class="st">"Y ~ i(f1, X2, ref = 1)"</span>, data<span class="op">=</span>data)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fit2.coef()[<span class="dv">0</span>:<span class="dv">8</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pyfixest-0.17.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.17.0">PyFixest 0.17.0</h2>
<ul>
<li><p>Restructures the codebase and reorganizes how users can interact with the <code>pyfixest</code> API. It is now recommended to use <code>pyfixest</code> in the following way:</p>
<div id="8e56ec4c" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pf.get_data()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"D"</span>] <span class="op">=</span> data[<span class="st">"X1"</span>] <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> pf.feols(<span class="st">"Y ~ D + f1"</span>, data <span class="op">=</span> data)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>fit.tidy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Estimate</th>
<th data-quarto-table-cell-role="th">Std. Error</th>
<th data-quarto-table-cell-role="th">t value</th>
<th data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th data-quarto-table-cell-role="th">2.5%</th>
<th data-quarto-table-cell-role="th">97.5%</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Coefficient</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>0.778849</td>
<td>0.170261</td>
<td>4.574437</td>
<td>0.000005</td>
<td>0.444737</td>
<td>1.112961</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">D</th>
<td>-1.402617</td>
<td>0.152224</td>
<td>-9.214140</td>
<td>0.000000</td>
<td>-1.701335</td>
<td>-1.103899</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">f1</th>
<td>0.004774</td>
<td>0.008058</td>
<td>0.592508</td>
<td>0.553645</td>
<td>-0.011038</td>
<td>0.020587</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The update should not inroduce any breaking changes. Thanks to <a href="https://github.com/Wenzhi-Ding"><span class="citation" data-cites="Wenzhi-Ding">@Wenzhi-Ding</span></a> for the PR!</p></li>
<li><p>Adds support for simultaneous confidence intervals via a multiplier bootstrap. Thanks to <a href="https://github.com/apoorvalal"><span class="citation" data-cites="apoorvalal">@apoorvalal</span></a> for the contribution!</p>
<div id="950a7971" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fit.confint(joint <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2.5%</th>
<th data-quarto-table-cell-role="th">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>0.381985</td>
<td>1.175713</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">D</th>
<td>-1.757438</td>
<td>-1.047795</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">f1</th>
<td>-0.014008</td>
<td>0.023556</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></li>
<li><p>Adds support for the causal cluster variance estimator by <a href="https://academic.oup.com/qje/article/138/1/1/6750017">Abadie et al.&nbsp;(QJE, 2023)</a> for OLS via the <code>.ccv()</code> method.</p>
<div id="a1d209f3" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fit.ccv(treatment <span class="op">=</span> <span class="st">"D"</span>, cluster <span class="op">=</span> <span class="st">"group_id"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/runner/work/pyfixest/pyfixest/pyfixest/estimation/feols_.py:1577: UserWarning: The initial model was not clustered. CRV1 inference is computed and stored in the model object.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Estimate</th>
<th data-quarto-table-cell-role="th">Std. Error</th>
<th data-quarto-table-cell-role="th">t value</th>
<th data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
<th data-quarto-table-cell-role="th">2.5%</th>
<th data-quarto-table-cell-role="th">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">CCV</th>
<td>-1.4026168622179929</td>
<td>0.291253</td>
<td>-4.815802</td>
<td>0.000139</td>
<td>-2.014517</td>
<td>-0.790717</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CRV1</th>
<td>-1.402617</td>
<td>0.205132</td>
<td>-6.837621</td>
<td>0.000002</td>
<td>-1.833584</td>
<td>-0.97165</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></li>
</ul>
</section>
<section id="pyfixest-0.16.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.16.0">PyFixest 0.16.0</h2>
<ul>
<li>Adds multiple quality of life improvements for developers, thanks to <a href="https://github.com/NKeleher">NKeleher</a>.</li>
<li>Adds more options to customize <code>etable()</code> output thanks to <a href="https://github.com/Wenzhi-Ding">Wenzhi-Ding</a>.</li>
<li>Implements Romano-Wolf and Bonferroni corrections for multiple testing in the <code>multcomp</code> module.</li>
</ul>
</section>
<section id="pyfixest-0.15." class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.15.">PyFixest 0.15.</h2>
<ul>
<li>Adds support for weighted least squares for <code>feols()</code>.</li>
<li>Reduces testing time drastically by running tests on fewer random data samples. Qualitatively, the set of test remains identical.</li>
<li>Some updates for future <code>pandas</code> compatibility.</li>
</ul>
</section>
<section id="pyfixest-0.14.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.14.0">PyFixest 0.14.0</h2>
<ul>
<li>Moves the documentation to <a href="https://github.com/machow/quartodoc">quartodoc</a>.</li>
<li>Changes all docstrings to <code>numpy</code> format.</li>
<li>Difference-in-differences estimation functions now need to be imported via the <code>pyfixest.did.estimation</code> module:</li>
</ul>
<div id="fc35e52b" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.did.estimation <span class="im">import</span> did2s, lpdid, event_study</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pyfixest-0.13.5" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.13.5">PyFixest 0.13.5</h2>
<ul>
<li>Fixes a bug that lead to incorrect results when the dependent variable and <strong>all covariates</strong> (excluding the fixed effects) where integers.</li>
</ul>
</section>
<section id="pyfixest-0.13.4" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.13.4">PyFixest 0.13.4</h2>
<ul>
<li>Fixes a bug in <code>etable()</code> with IV’s that occurred because <code>feols()</code> does not report R2 statistics for IVs.</li>
</ul>
</section>
<section id="pyfixest-0.13.2" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.13.2">PyFixest 0.13.2</h2>
<ul>
<li>Fixes a bug in <code>etable()</code> and a warning in <code>fixest_model_matrix</code> that arose with higher <code>pandas</code> versions. Thanks to <span class="citation" data-cites="aeturrell">@aeturrell</span> for reporting!</li>
</ul>
</section>
<section id="pyfixest-0.13.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.13.0">PyFixest 0.13.0</h2>
<section id="new-features-2" class="level3">
<h3 class="anchored" data-anchor-id="new-features-2">New Features</h3>
<ul>
<li>Introduces a new <code>pyfixest.did</code> module which contains routines for Difference-in-Differences estimation.</li>
<li>Introduces support for basic versions of the local projections DiD estimator following <a href="https://www.nber.org/papers/w31184">Dube et al (2023)</a></li>
<li>Adds a new vignette for Difference-in-Differences estimation.</li>
<li>Reports R2 values in <code>etable()</code>.</li>
</ul>
</section>
</section>
<section id="pyfixest-0.12.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.12.0">PyFixest 0.12.0</h2>
<section id="enhancements" class="level3">
<h3 class="anchored" data-anchor-id="enhancements">Enhancements:</h3>
<ul>
<li>Good performance improvements for singleton fixed effects detection. Thanks to <a href="https://github.com/styfenschaer"><span class="citation" data-cites="styfenschaer">@styfenschaer</span></a> for the PR! See <a href="https://github.com/py-econometrics/pyfixest/issues/229">#229</a>.</li>
<li>Uses the <a href="https://github.com/eddelbuettel/r2u">r2u project</a> for installing R and R packages on github actions, with great performance improvements.</li>
<li>Allows to pass <code>polars</code> data frames to <code>feols()</code>, <code>fepois()</code> and <code>predict()</code>. <a href="https://github.com/py-econometrics/pyfixest/issues/232">#232</a>. Thanks to <a href="https://github.com/py-econometrics/pyfixest/issues/232"><span class="citation" data-cites="vincentarelbundock">@vincentarelbundock</span></a> for the suggestion!</li>
</ul>
</section>
<section id="bug-fixes-1" class="level3">
<h3 class="anchored" data-anchor-id="bug-fixes-1">Bug Fixes:</h3>
<ul>
<li>Missing variables in features were not always handled correctly in <code>predict()</code> with <code>newdata</code> not <code>None</code> in the presence of missing data, which would lead to an error. See <a href="https://github.com/py-econometrics/pyfixest/issues/246">#246</a> for details.</li>
<li>Categorical variables were not always handled correctly in <code>predict()</code> with <code>newdata</code> not <code>None</code>, because the number of fixed effects levels in <code>newdata</code> might be smaller than in <code>data</code>. In consequence, some levels were not found, which lead to an error. See <a href="https://github.com/py-econometrics/pyfixest/issues/245">#245</a> for details. Thanks to <a href="https://github.com/jiafengkevinchen"><span class="citation" data-cites="jiafengkevinchen">@jiafengkevinchen</span></a> for the pointer!</li>
<li>Multicollinearity checks for over-identified IV was not implemented correctly, which lead to a dimension error. See <a href="https://github.com/py-econometrics/pyfixest/issues/236">#236</a> for details. Thanks to <a href="https://github.com/jiafengkevinchen"><span class="citation" data-cites="jiafengkevinchen">@jiafengkevinchen</span></a> for the pointer!</li>
<li>The number of degrees of freedom <code>k</code> was computed incorrectly if columns were dropped from the design matrix <code>X</code> in the presence of multicollinearity. See <a href="https://github.com/py-econometrics/pyfixest/issues/235">#235</a> for details. Thanks to <a href="https://github.com/jiafengkevinchen"><span class="citation" data-cites="jiafengkevinchen">@jiafengkevinchen</span></a> for the pointer!</li>
<li>If all variables were dropped due to multicollinearity, an unclear and imprecise error message was produced. See <a href="https://github.com/py-econometrics/pyfixest/issues/228">#228</a> for details. Thanks to <a href="https://github.com/manferdinig"><span class="citation" data-cites="manferdinig">@manferdinig</span></a> for the pointer!</li>
<li>If selection <code>fixef_rm = 'singleton'</code>, <code>feols()</code> and <code>fepois()</code> would fail, which has been fixed. <a href="https://github.com/py-econometrics/pyfixest/issues/192">#192</a></li>
</ul>
</section>
<section id="dependency-requirements" class="level3">
<h3 class="anchored" data-anchor-id="dependency-requirements">Dependency Requirements</h3>
<ul>
<li>For now, sets <code>formulaic</code> versions to be <code>0.6.6</code> or lower as version <code>1.0.0</code> seems to have introduced a problem with the <code>i()</code> operator, See <a href="https://github.com/py-econometrics/pyfixest/issues/244">#244</a> for details.</li>
<li>Drops dependency on <code>pyhdfe</code>.</li>
</ul>
</section>
</section>
<section id="pyfixest-0.11.1" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.11.1">PyFixest 0.11.1</h2>
<ul>
<li>Fixes some bugs around the computation of R-squared values (see <a href="https://github.com/py-econometrics/pyfixest/issues/103">issue #103</a>).</li>
<li>Reports R-squared values again when calling <code>.summary()</code>.</li>
</ul>
</section>
<section id="pyfixest-0.11.0" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.11.0">PyFixest 0.11.0</h2>
<ul>
<li>Significant speedups for CRV1 inference.</li>
</ul>
</section>
<section id="pyfixest-0.10.12" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.12">PyFixest 0.10.12</h2>
<p>Fixes a small bug with the separation check for poisson regression #138.</p>
</section>
<section id="pyfixest-0.10.11" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.11">PyFixest 0.10.11</h2>
<p>Fixes bugs with i(var1, var2) syntax introduced with PyFixest 0.10.10.</p>
</section>
<section id="pyfixest-0.10.10" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.10">PyFixest 0.10.10</h2>
<p>Fixes a bug with variable interactions via <code>i(var)</code> syntax. See <a href="https://github.com/py-econometrics/pyfixest/issues/211">issue #221</a>.</p>
</section>
<section id="pyfixest-0.10.9" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.9">PyFixest 0.10.9</h2>
<p>Makes <code>etable()</code> prettier and more informative.</p>
</section>
<section id="pyfixest-0.10.8" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.8">PyFixest 0.10.8</h2>
<section id="breaking-changes" class="level3">
<h3 class="anchored" data-anchor-id="breaking-changes">Breaking changes</h3>
<p>Reference levels for the <code>i()</code> formula syntax can no longer be set within the formula, but need to be added via the <code>i_ref1</code> function argument to either <code>feols()</code> and <code>fepois()</code>.</p>
</section>
<section id="new-feature" class="level3">
<h3 class="anchored" data-anchor-id="new-feature">New feature</h3>
<p>A <code>dids2()</code> function is added, which implements the 2-stage difference-in-differences procedure à la Gardner and follows the syntax of <span class="citation" data-cites="kylebutts">@kylebutts</span> <a href="https://github.com/kylebutts/did2s">did2s</a> R package.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.did.did <span class="im">import</span> did2s</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.estimation <span class="im">import</span> feols</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.visualize <span class="im">import</span> iplot</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>df_het <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/py-econometrics/pyfixest/master/pyfixest/did/data/df_het.csv"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> did2s(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    df_het,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    yname <span class="op">=</span> <span class="st">"dep_var"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    first_stage <span class="op">=</span> <span class="st">"~ 0 | state + year"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    second_stage <span class="op">=</span> <span class="st">"~i(rel_year)"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    treatment <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    cluster <span class="op">=</span> <span class="st">"state"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    i_ref1 <span class="op">=</span> [<span class="op">-</span><span class="fl">1.0</span>, np.inf],</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>fit_twfe <span class="op">=</span> feols(</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dep_var ~ i(rel_year) | state + year"</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    df_het,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    i_ref1 <span class="op">=</span> [<span class="op">-</span><span class="fl">1.0</span>, np.inf]</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>iplot([fit, fit_twfe], coord_flip<span class="op">=</span><span class="va">False</span>, figsize <span class="op">=</span> (<span class="dv">900</span>, <span class="dv">400</span>), title <span class="op">=</span> <span class="st">"TWFE vs DID2S"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><img src="figures/event_study.svg" class="img-fluid"></p>
</section>
</section>
<section id="pyfixest-0.10.7" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.7">PyFixest 0.10.7</h2>
<ul>
<li>Adds basic support for event study estimation via two-way fixed effects and Gardner’s two-stage “Did2s” approach. This is a beta version and experimental. Further updates (i.e.&nbsp;proper event studies vs “only” ATTs) and a more flexible did2s front end will follow in future releases.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.did.did <span class="im">import</span> event_study</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>df_het <span class="op">=</span> pd.read_csv(<span class="st">"pyfixest/did/data/df_het.csv"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>fit_twfe <span class="op">=</span> event_study(</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df_het,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    yname <span class="op">=</span> <span class="st">"dep_var"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    idname<span class="op">=</span> <span class="st">"state"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    tname <span class="op">=</span> <span class="st">"year"</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    gname <span class="op">=</span> <span class="st">"g"</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    estimator <span class="op">=</span> <span class="st">"twfe"</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>fit_did2s <span class="op">=</span> event_study(</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df_het,</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    yname <span class="op">=</span> <span class="st">"dep_var"</span>,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    idname<span class="op">=</span> <span class="st">"state"</span>,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    tname <span class="op">=</span> <span class="st">"year"</span>,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    gname <span class="op">=</span> <span class="st">"g"</span>,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    estimator <span class="op">=</span> <span class="st">"did2s"</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>pf.etable([fit_twfe, fit_did2s])</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="co"># | Coefficient   | est1             | est2             |</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="co"># |:--------------|:-----------------|:-----------------|</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="co"># | ATT           | 2.135*** (0.044) | 2.152*** (0.048) |</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Significance levels: * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pyfixest-0.10.6" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.6">PyFixest 0.10.6</h2>
<ul>
<li>Adds an <code>etable()</code> function that outputs markdown, latex or a pd.DataFrame.</li>
</ul>
</section>
<section id="pyfixest-0.10.5" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.5">PyFixest 0.10.5</h2>
<ul>
<li>Fixes a big in IV estimation that would trigger an error. See <a href="https://github.com/py-econometrics/pyfixest/issues/197">here</a> for details. Thanks to <span class="citation" data-cites="aeturrell">@aeturrell</span> for reporting!</li>
</ul>
</section>
<section id="pyfixest-0.10.4" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.4">PyFixest 0.10.4</h2>
<ul>
<li>Implements a custom function to drop singleton fixed effects.</li>
<li>Additional small performance improvements.</li>
</ul>
</section>
<section id="pyfixest-0.10.3" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.3">PyFixest 0.10.3</h2>
<ul>
<li>Allows for white space in the multiway clustering formula.</li>
<li>Adds documentation for multiway clustering.</li>
</ul>
</section>
<section id="pyfixest-0.10.2" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.2">PyFixest 0.10.2</h2>
<ul>
<li>Adds support for two-way clustering.</li>
<li>Adds support for CRV3 inference for Poisson regression.</li>
</ul>
</section>
<section id="pyfixest-0.10.1" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10.1">PyFixest 0.10.1</h2>
<ul>
<li>Adapts the internal fixed effects demeaning criteron to match `PyHDFE’s default.</li>
<li>Adds Styfen as coauthor.</li>
</ul>
</section>
<section id="pyfixest-0.10" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.10">PyFixest 0.10</h2>
<ul>
<li>Multiple performance improvements.</li>
<li>Most importantly, implements a custom demeaning algorithm in <code>numba</code> - thanks to Styfen Schaer (<span class="citation" data-cites="styfenschaer">@styfenschaer</span>), which leads to performance improvements of 5x or more:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyhdfe</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.demean <span class="im">import</span> demean</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1238</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10_000_000</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span><span class="op">*</span>N).reshape((N,<span class="dv">10</span>))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> np.random.choice(<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000</span>)), N).reshape((N,<span class="dv">1</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> np.random.choice(<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000</span>)), N).reshape((N,<span class="dv">1</span>))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>flist <span class="op">=</span> np.concatenate((f1, f2), axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> np.ones(N)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>algorithm <span class="op">=</span> pyhdfe.create(flist)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>res_pyhdfe <span class="op">=</span> algorithm.residualize(x)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> time.time()</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(end_time <span class="op">-</span> start_time)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 26.04527711868286</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>res_pyfixest, success <span class="op">=</span> demean(x, flist, weights, tol <span class="op">=</span> <span class="fl">1e-10</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the execution time</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> time.time()</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(end_time <span class="op">-</span> start_time)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co">#4.334428071975708</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>np.allclose(res_pyhdfe , res_pyfixest)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="co"># True</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pyfixest-0.9.11" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.11">PyFixest 0.9.11</h2>
<ul>
<li>Bump required <code>formulaic</code> version to <code>0.6.5</code>.</li>
<li>Stop copying the data frame in <code>fixef()</code>.</li>
</ul>
</section>
<section id="pyfixest-0.9.10" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.10">PyFixest 0.9.10</h2>
<ul>
<li>Fixes a big in the <code>wildboottest</code> method (see <a href="https://github.com/py-econometrics/pyfixest/issues/158">#158</a>).</li>
<li>Allows to run a wild bootstrap after fixed effect estimation.</li>
</ul>
</section>
<section id="pyfixest-0.9.9" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.9">PyFixest 0.9.9</h2>
<ul>
<li>Adds support for <code>wildboottest</code> for Python <code>3.11</code>.</li>
</ul>
</section>
<section id="pyfixest-0.9.8" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.8">PyFixest 0.9.8</h2>
<ul>
<li>Fixes a couple more bugs in the <code>predict()</code> and <code>fixef()</code> methods.</li>
<li>The <code>predict()</code> argument <code>data</code> is renamed to <code>newdata</code>.</li>
</ul>
</section>
<section id="pyfixest-0.9.7" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.7">PyFixest 0.9.7</h2>
<p>Fixes a bug in <code>predict()</code> produced when multicollinear variables are dropped.</p>
</section>
<section id="pyfixest-0.9.6" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.6">PyFixest 0.9.6</h2>
<p>Improved Collinearity handling. See <a href="https://github.com/py-econometrics/pyfixest/issues/145">#145</a></p>
</section>
<section id="pyfixest-0.9.5" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.5">PyFixest 0.9.5</h2>
<ul>
<li>Moves plotting from <code>matplotlib</code> to <code>lets-plot</code>.</li>
<li>Fixes a few minor bugs in plotting and the <code>fixef()</code> method.</li>
</ul>
</section>
<section id="pyfixest-0.9.1" class="level2">
<h2 class="anchored" data-anchor-id="pyfixest-0.9.1">PyFixest 0.9.1</h2>
<section id="breaking-api-changes" class="level3">
<h3 class="anchored" data-anchor-id="breaking-api-changes">Breaking API changes</h3>
<p>It is no longer required to initiate an object of type <code>Fixest</code> prior to running [Feols(/reference/Feols.qmd) or <code>fepois</code>. Instead, you can now simply use <code>feols()</code> and <code>fepois()</code> as functions, just as in <code>fixest</code>. Both function can be found in an <code>estimation</code> module and need to obtain a <code>pd.DataFrame</code> as a function argument:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.estimation <span class="im">import</span> fixest, fepois</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.utils <span class="im">import</span> get_data</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> get_data()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> feols(<span class="st">"Y ~ X1 | f1"</span>, data <span class="op">=</span> data, vcov <span class="op">=</span> <span class="st">"iid"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Calling <code>feols()</code> will return an instance of class [Feols(/reference/Feols.qmd), while calling <code>fepois()</code> will return an instance of class <code>Fepois</code>. Multiple estimation syntax will return an instance of class <code>FixestMulti</code>.</p>
<p>Post processing works as before via <code>.summary()</code>, <code>.tidy()</code> and other methods.</p>
</section>
<section id="new-features-3" class="level3">
<h3 class="anchored" data-anchor-id="new-features-3">New Features</h3>
<p>A summary function allows to compare multiple models:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.summarize <span class="im">import</span> summary</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="op">=</span> feols(<span class="st">"Y ~ X1 + X2| f1"</span>, data <span class="op">=</span> data, vcov <span class="op">=</span> <span class="st">"iid"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>summary([fit, fit2])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Visualization is possible via custom methods (<code>.iplot()</code> &amp; <code>.coefplot()</code>), but a new module allows to visualize a list of [Feols(/reference/Feols.qmd) and/or <code>Fepois</code> instances:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyfixest.visualize <span class="im">import</span> coefplot, iplot</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>coefplot([fit, fit2])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The documentation has been improved (though there is still room for progress), and the code has been cleaned up a bit (also lots of room for improvements).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>